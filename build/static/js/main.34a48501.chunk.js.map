{"version":3,"sources":["utils/polyfill/index.js","components/Reset.js","components/Import.js","components/ReversalCard/index.js","components/Chart/Chart.js","components/Chart/LineChart.js","utils/simulate.js","components/SimulateCard/index.js","components/SimulateCard/SimulateSetting.js","components/StockItem.js","components/PositionItem.js","components/AddPostionItem.js","components/Position.js","reducers/index.js","components/StockList.js","components/StockPanel.js","components/SummaryPanel.js","Dashbord.js","App.js","serviceWorker.js","index.js","utils/common.js","constants/index.js"],"names":["Object","values","object","keys","map","key","useStyles","makeStyles","theme","button","color","fontSize","Transition","React","forwardRef","props","ref","Slide","direction","Rest","classes","useState","open","setOpen","handleClose","Fragment","Button","size","onClick","className","Dialog","TransitionComponent","keepMounted","onClose","aria-labelledby","aria-describedby","DialogTitle","id","DialogContent","DialogContentText","DialogActions","onConfirm","textTransform","icon","tips","Import","jsonText","setJsonText","error","setError","IconButton","aria-label","onSubmit","e","preventDefault","json","JSON","parse","error1","Array","isArray","TextField","required","autoFocus","multiline","rowsMax","rows","variant","margin","name","label","type","Boolean","helperText","value","onChange","text","String","target","trim","InputProps","inputProps","pattern","fullWidth","root","position","face","width","backfaceVisibility","transformStyle","transition","back","height","memo","on","reversal","children","cardFaceEl","useRef","rect","setRect","useEffect","current","getBoundingClientRect","style","transform","prevProps","nextProps","update","Math","random","toString","substring","chart","init","creator","data","F2","Chart","pixelRatio","window","devicePixelRatio","appendPadding","this","destroy","next","changeData","source","Component","LineChart","boxRef","Number","document","documentElement","getAttribute","scale","tickCount","tooltip","custom","showXTip","showYTip","snap","crosshairsType","crosshairsStyle","lineDash","line","shape","point","area","render","state","boxRect","setState","boxStyles","node","length","PureComponent","simulate","initValue","options","costPrice","earnRate","p","cycle","up","down","onlineRecords","soldRecords","buyRecords","upRecords","percents","downRecords","noneRecords","idx","percent","randomP","push","lastRecord","threshold","newRecord","doSold","soldRecord","doBuy","buyRecord","record","buyCb","prePostion","optPostion","optPercent","newPrice","newPostion","newCostPrice","newEarnRate","price","amount","addPostion","soldCb","abs","earnMoney","reducePostion","lineSource","setuLineSource","stock","simulateInitData","forEach","v","x","y","row","display","alignItems","flexWrap","center","textAlign","mediumWidth","SimulateSetting","setValues","handleInputChange","placeholder","min","max","endAdornment","InputAdornment","down_position","up_threshold","up_position","caclClass","number","StockItem","simulateOptions","down_threshold","handleRevesalClick","handleConfirm","handleUpdateSimulate","Date","valueOf","url","bcLinkData","eq","bcFn","toFixed","jcLinkData","jcFn","linkData","base64","btoa","stringify","replace","calcLink","summary","earningsPerShare","earningCls","advice","maxAbsEarnRate","earn","maxAbsRate","inPercent","toMultiple","simulateOpts","formatSimulateValues","flex","endIcon","handleLinkClick","floor","ceil","approValue","SCHEMA","symbol","PostionItem","onComplete","validateShema","every","schemaKey","rule","onDelete","edit","defaultValue","AddPostionItem","handleAdd","onAdd","stocks","isValid","some","alert","startIcon","Position","handleComplete","index","onItemComplete","stocksMap","reduce","filter","sort","a","b","handleAddRowClick","addStockItem","core","stockInitData","showPostion","isEdit","stockReducer","action","initialData","payload","StockContext","createContext","saveButton","editButton","sortTool","TYPE_MAP","asce","desc","StockList","dispatch","setStocks","editStocks","setEditStocks","setSort","split","sortedStocks","stockState","useContext","list","ratio","s1","s2","Select","MenuItem","localStocks","formatToLocalStocks","localStorage","setItem","onSave","hanldPostionClick","console","log","filterStocks","heading","typography","pxToRem","flexBasis","flexShrink","panel","padding","StockPanel","expanded","setExpanded","ExpansionPanel","event","isExpanded","ExpansionPanelSummary","expandIcon","aria-controls","Typography","ExpansionPanelDetails","detial","defaultColor","SummaryPanel","haha","paragraph","marketValue","costValue","hotMoney","$","header","justifyContent","marginTop","marginBottom","cursor","snackbar","backgroundColor","timer","DashBord","setStocksMap","stockList","setStockList","message","setTips","setSummary","useReducer","stockRef","fetchStocks","success","fail","localStockStr","getItem","STOCKS","stockCodes","ajax","dataType","API_BASE_URL","getStockCodes","join","serverData","status","xhr","mergeStocks","calcStockSummary","initData","setInterval","UPDATE_INTERVAL","clearInterval","Provider","resetData","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","addEventListener","globalError","App","location","hostname","match","ReactDOM","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","code","isNaN","toLowerCase","indexOf","toUpperCase","genFnForBC","soryBy","calcApproximateValue","formula","targetValue","step","startX","endX","cycleCount","realCycleCount","count","i","resultMap","vX","formulaStr","putIntoFormula","result","eval","delta","times","minDelta","approObj","pageView","defaultJson","serverStocks","stockMap","sum","localStock","stockItem","ADVICE_LOSS_RATE","EXPECT_LOSS_RATE","minRate","maxRate","minMoney","maxMoney","item","adviceAmount","Big","plus","div","minus","sortedByEarnRateList","minRateStock","maxRateStock","n","m","n1","m1","to","variableKey","variable","matchs","RegExp","newFormula","variableIdx","prevChart","nextChart","test","replaceAt","prototype","replacement","substr","keySplit","key0","key1"],"mappings":"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","file":"static/js/main.34a48501.chunk.js","sourcesContent":["const objectToValuesPolyfill = (object) => {\n  return Object.keys(object).map(key => object[key]);\n};\n\nObject.values = Object.values || objectToValuesPolyfill;","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\n\nconst useStyles = makeStyles(theme => ({\n  button: {\n    color: '#555',\n    fontSize: 12,\n  }\n}));\n\nconst Transition = React.forwardRef(function Transition(props, ref) {\n  return <Slide direction=\"up\" ref={ref} {...props} />;\n});\n\nexport default function Rest(props) {\n  const classes = useStyles();\n  const [open, setOpen] = React.useState(false);\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleConfirm = () => {\n    setOpen(false);\n    props.onConfirm && props.onConfirm();\n  };\n\n  return (\n    <React.Fragment>\n      <Button size=\"small\" onClick={handleClickOpen} className={classes.button}>\n        reset\n      </Button>\n      <Dialog\n        open={open}\n        TransitionComponent={Transition}\n        keepMounted\n        onClose={handleClose}\n        aria-labelledby=\"alert-dialog-slide-title\"\n        aria-describedby=\"alert-dialog-slide-description\"\n      >\n        <DialogTitle id=\"alert-dialog-slide-title\">确定要重置持仓吗?</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-dialog-slide-description\">\n            重置后持仓将恢复默认的示例数据，该操作不可撤销。\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} color=\"primary\">\n            取消\n          </Button>\n          <Button onClick={handleConfirm} color=\"primary\">\n            确定\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </React.Fragment>\n  );\n}\n","import React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\nimport IconButton from '@material-ui/core/IconButton';\nimport TextField from '@material-ui/core/TextField';\nimport ImportExportIcon from '@material-ui/icons/ImportExport';\n\nconst useStyles = makeStyles((theme) => ({\n  button: {\n    color: '#888',\n    textTransform: 'uppercase',\n    fontSize: 15,\n  },\n  icon: {\n    fontSize: 20,\n  },\n  tips: {\n    fontSize: 14,\n  }\n}));\n\nconst Transition = React.forwardRef(function Transition(props, ref) {\n  return <Slide direction=\"up\" ref={ref} {...props} />;\n});\n\nexport default function Import(props) {\n  const classes = useStyles();\n\n  const [open, setOpen] = useState(false);\n  const [jsonText, setJsonText] = useState('');\n  const [error, setError] = useState('');\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleConfirm = () => {\n  };\n\n  const handleTextChange = (e) => {\n    const text = String(e.target.value).trim();\n    setJsonText(text);\n\n    text === '' && setError(false);\n  };\n\n  const handleSubmit = (e, values) => {\n    e.preventDefault();\n    let json = false;\n\n    try {\n      json = JSON.parse(jsonText);\n      setError(false);\n    } catch (error1) {\n      setError('JSON解析错误, 请核验格式是否正确');\n      return;\n    }\n    if (!Array.isArray(json)) {\n      setError('JSON必须是一个持仓数组');\n      return;\n    }\n    if (json) {\n      setOpen(false);\n      setJsonText('');\n      props.onConfirm && props.onConfirm(json);\n    }\n  };\n\n  return (\n    <React.Fragment>\n      <IconButton aria-label=\"import\" size=\"small\" onClick={handleClickOpen} className={classes.button}>\n        <ImportExportIcon size=\"small\" className={classes.icon} />\n      </IconButton>\n      <Dialog\n        open={open}\n        TransitionComponent={Transition}\n        keepMounted\n        onClose={handleClose}\n        aria-labelledby=\"alert-dialog-slide-title\"\n        aria-describedby=\"alert-dialog-slide-description\"\n      >\n        <form onSubmit={handleSubmit}>\n          <DialogTitle id=\"alert-dialog-slide-title\">导入数据</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"alert-dialog-slide-description\" className={classes.tips}>\n              你可以通过导入JSON来快速初始化你的持仓数据。该操作会覆盖现有数据，请谨慎操作。\n            </DialogContentText>\n            <TextField\n              required\n              autoFocus\n              multiline\n              rowsMax=\"6\"\n              rows=\"2\"\n              variant=\"outlined\"\n              margin=\"dense\"\n              name=\"position\"\n              id=\"position\"\n              label=\"JSON字符串\"\n              type=\"text\"\n              error={Boolean(error)}\n              helperText={error}\n              value={jsonText}\n              onChange={handleTextChange}\n              InputProps={{\n                inputProps: {\n                  pattern: /^\\D/,\n                },\n              }}\n              fullWidth\n            />\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={handleClose} color=\"primary\">\n              取消\n            </Button>\n            <Button onClick={handleConfirm} color=\"primary\" type=\"submit\">\n              确定\n            </Button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </React.Fragment>\n  );\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    position: 'relative',\n  },\n  face: {\n    position: 'absolute',\n    width: '100%',\n    backfaceVisibility: 'hidden',\n    transformStyle: 'preserve-3d',\n    transition: 'transform 2s',\n  },\n  back: {\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    backfaceVisibility: 'hidden',\n    transformStyle: 'preserve-3d',\n    transition: 'transform 2s',\n  },\n}));\n\nfunction ReversalCard(props) {\n  const { on = false, reversal, children, className = '' } = props;\n  const classes = useStyles();\n  const cardFaceEl = useRef(null);\n  const [rect, setRect] = useState({});\n\n  useEffect(() => {\n    if (cardFaceEl) {\n      const rect = cardFaceEl.current.getBoundingClientRect();\n      setRect(rect);\n    }\n  }, []);\n\n  return (\n    <div\n      className={`${className} ${classes.root}`}\n      style={{\n        width: rect.width,\n        height: rect.height,\n      }}\n    >\n      <div\n        className={`reversal-card-face ${classes.face}`}\n        style={{\n          transform: on ? 'rotateY(180deg)' : 'rotateY(0deg)',\n        }}\n        ref={cardFaceEl}\n      >\n        {children}\n      </div>\n      <div\n        className={`reversal-card-back ${classes.back}`}\n        style={{\n          transform: on ? 'rotateY(0deg)' : 'rotateY(-180deg)',\n        }}\n      >\n        {reversal}\n      </div>\n    </div>\n  );\n}\n\nfunction areEqual(prevProps, nextProps) {\n  /*\n  如果把 nextProps 传入 render 方法的返回结果与\n  将 prevProps 传入 render 方法的返回结果一致则返回 true，\n  否则返回 false\n  */\n  // console.log('areEqual', nextProps.update, prevProps.on === nextProps.on);\n  return prevProps.on === nextProps.on && prevProps.update === nextProps.update;\n}\n\nexport default React.memo(ReversalCard, areEqual);\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport F2 from '@antv/f2';\n\nexport default class extends Component {\n  static propTypes = {\n    creator: PropTypes.func.isRequired,\n    data: PropTypes.object.isRequired,\n    // width: PropTypes.number.isRequired,\n    // height: PropTypes.number.isRequired,\n  };\n\n  id = `c${Math.random()\n    .toString(36)\n    .substring(7)}`;\n\n  chart = null;\n\n  init = () => {\n    const { width, height, creator, data } = this.props;\n    const chart = new F2.Chart({\n      id: this.id,\n      width,\n      height,\n      pixelRatio: window.devicePixelRatio,\n      // padding: [30, 0, 0, 0],\n      appendPadding: [30, 20, 0, 0],\n    });\n\n    creator(chart, data);\n    this.chart = chart;\n  };\n\n  componentDidMount() {\n    this.init();\n  }\n\n  componentWillUnmount() {\n    this.chart.destroy();\n    this.chart = null;\n  }\n\n  componentWillReceiveProps(next) {\n    if (next.data !== this.props.data) {\n      this.chart.changeData(next.data.source);\n    }\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  render() {\n    return <canvas id={this.id} />;\n  }\n}\n","import React, { PureComponent } from 'react';\nimport Chart from './Chart';\n\nexport default class LineChart extends PureComponent {\n  boxRef = null;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      boxRect: {\n        width: 0,\n        height: 0,\n      },\n    };\n  }\n\n  componentDidMount() {\n    if (this.boxRef) {\n      const boxRect = this.boxRef.getBoundingClientRect();\n      this.setState({\n        boxRect: { width: boxRect.width, height: boxRect.height },\n      });\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.boxRef) {\n      const { height, width } = this.state.boxRect;\n      const boxRect = this.boxRef.getBoundingClientRect();\n      if (height !== boxRect.height || width !== boxRect.width) {\n        this.setState({\n          boxRect: { width: boxRect.width, height: boxRect.height },\n        });\n      }\n    }\n  }\n\n  creator = (chart, data) => {\n    const { source } = data;\n    // 获取html设置的dpr\n    const devicePixelRatio = Number(document.documentElement.getAttribute('data-dpr')) || 1;\n\n    chart.source(source);\n\n    chart.scale('x', {\n      type: 'cat',\n      tickCount: 10,\n    });\n    chart.scale('y', {\n      tickCount: 0,\n    });\n\n    chart.tooltip({\n      custom: true,\n      showXTip: true,\n      showYTip: true,\n      snap: true,\n      crosshairsType: 'xy',\n      crosshairsStyle: {\n        lineDash: [2],\n      },\n    });\n\n    chart\n      .line()\n      .position('x*y')\n      .color('type')\n      .size(2 * devicePixelRatio)\n      .shape('type', (type) => {\n        if (type === '预期收益') {\n          return 'line';\n        }\n        if (type === '市场收益') {\n          return 'dash';\n        }\n      });\n\n    chart\n      .point()\n      .position('x*y')\n      .color('type')\n      .size(2 * devicePixelRatio)\n      .shape('smooth');\n\n    chart.area().position('x*y').color('type').shape('smooth');\n\n    chart.render();\n  };\n\n  render() {\n    const { data, width, height } = this.props;\n    const { boxRect } = this.state;\n    const { source = [] } = data;\n\n    const boxStyles = {\n      width,\n      height,\n    };\n\n    return (\n      <div className=\"jsChartWrap\" ref={(node) => (this.boxRef = node)} style={boxStyles}>\n        {boxRect.width && boxRect.height && source.length ? (\n          <Chart data={{ source }} width={boxRect.width} height={boxRect.height} creator={this.creator} />\n        ) : null}\n      </div>\n    );\n  }\n}\n","/**\n *\n * @param {object} params 参数\n */\nexport function simulate(initValue, options) {\n  const { costPrice, position, earnRate } = initValue;\n  const { p, cycle, up, down } = options;\n\n  // 持仓记录\n  const onlineRecords = [\n    {\n      costPrice,\n      position,\n      earnRate,\n    },\n  ];\n  // 减仓记录\n  const soldRecords = [];\n  // 加仓记录\n  const buyRecords = [];\n  // 上涨记录\n  const upRecords = {\n    percents: [],\n  };\n  // 下跌记录\n  const downRecords = {\n    percents: [],\n  };\n  // 无操作记录。例如：上涨打到阈值，但持仓为0，无法卖出\n  const noneRecords = {\n    percents: [],\n  };\n\n  for (let idx = 1; idx <= cycle; idx++) {\n    let percent = 0;\n\n    if (randomP(p) === 1) {\n      // 概率为p的事件逻辑,即上涨逻辑\n      percent = Math.random() * 0.1;\n      upRecords.percents.push(percent);\n    } else {\n      // 概率为1-p的事件逻辑，即下跌逻辑\n      percent = Math.random() * -0.1;\n      downRecords.percents.push(percent);\n    }\n\n    const lastRecord = onlineRecords[onlineRecords.length - 1];\n    if (percent >= up.threshold) {\n      // 上涨卖\n      if (lastRecord.position > 0) {\n        const newRecord = doSold(lastRecord, { percent, position: up.position }, (soldRecord) => {\n          // console.log('卖出部分：', soldRecord);\n          soldRecords.push(soldRecord);\n        });\n\n        // console.log('上涨卖：', newRecord);\n        onlineRecords.push({ ...newRecord, percent });\n      } else {\n        noneRecords.percents.push(percent);\n        // console.log('上涨空窗期,position已经为0', lastRecord);\n      }\n    } else if (percent <= down.threshold) {\n      // 下跌买\n      const newRecord = doBuy(lastRecord, { percent, position: down.position }, (buyRecord) => {\n        buyRecords.push(buyRecord);\n      });\n\n      // console.log('下跌买：', newRecord);\n      onlineRecords.push({ ...newRecord, percent });\n    } else {\n      // 不操作\n    }\n  }\n\n  const result = { cycle, onlineRecords, soldRecords, buyRecords, upRecords, downRecords, noneRecords };\n\n  return result;\n}\n\n// 分析结果\nfunction analyze(result) {\n  const { cycle, upRecords, downRecords, onlineRecords, soldRecords, buyRecords } = result;\n\n  // 卖出的收益\n  const soldEarnAmount = soldRecords.reduce((sum, item) => {\n    return (sum += item.earnMoney);\n  }, 0);\n\n  // 买入合计金额\n  const buyAmount = buyRecords.reduce((sum, item) => {\n    return (sum += item.amount);\n  }, 0);\n\n  const currentAccout = onlineRecords[onlineRecords.length - 1];\n\n  return {\n    cycle,\n    up: {\n      count: upRecords.percents.length,\n    },\n    down: {\n      count: downRecords.percents.length,\n    },\n    earn: {\n      online: {\n        ...currentAccout,\n        earmMoney: currentAccout.costPrice * currentAccout.position * currentAccout.earnRate,\n      },\n      sold: {\n        count: soldRecords.length,\n        earnAmount: soldEarnAmount,\n      },\n      buy: {\n        count: buyRecords.length,\n        buyAmout: buyAmount,\n      },\n    },\n    source: result,\n  };\n}\n\n// 生成概率p\nfunction randomP(p) {\n  if (Math.random() <= Number(p)) {\n    return 1;\n  } else {\n    return 0;\n  }\n}\n\n// 买操作\nfunction doBuy(record, options, buyCb) {\n  return addPostion(record, options, buyCb);\n}\n\n// 卖操作\nfunction doSold(record, options, soldCb) {\n  return reducePostion(record, options, soldCb);\n}\n\n// 加仓\nfunction addPostion(prePostion, options, buyCb) {\n  const { costPrice, position, earnRate } = prePostion;\n  const optPostion = Number(options.position);\n  const optPercent = Number(options.percent);\n\n  // 原本的价格\n  const price = (earnRate + 1) * costPrice;\n  // 变动后的价格\n  const newPrice = (optPercent + 1) * price;\n  // 新的持仓\n  const newPostion = position + optPostion;\n  // 新的成本\n  const newCostPrice = (costPrice * position + newPrice * optPostion) / newPostion;\n  // 新的收益率\n  const newEarnRate = newPrice / newCostPrice - 1;\n\n  buyCb({\n    percent: optPercent,\n    price: newPrice,\n    costPrice: newPrice,\n    position: optPostion,\n    amount: newPrice * optPostion,\n  });\n\n  return {\n    percent: optPercent,\n    price: newPrice,\n    costPrice: newCostPrice,\n    position: newPostion,\n    earnRate: newEarnRate,\n  };\n}\n\n// 减仓\nfunction reducePostion(prePostion, options, soldCb) {\n  const { costPrice, position, earnRate } = prePostion;\n  const optPostion = Number(options.position);\n  const optPercent = Number(options.percent);\n\n  // 原本的价格\n  const price = (earnRate + 1) * costPrice;\n  // 变动后的价格\n  const newPrice = (optPercent + 1) * price;\n  // 新的持仓\n  const newPostion = position + optPostion;\n  // 新的收益率\n  const newEarnRate = newPrice / costPrice - 1;\n\n  const soldRecord = {\n    percent: optPercent,\n    costPrice: costPrice,\n    price: newPrice,\n    position: Math.abs(optPostion),\n    earnRate: newEarnRate,\n    earnMoney: costPrice * Math.abs(optPostion) * newEarnRate,\n  };\n\n  // console.log('上涨', optPercent, price, newPrice);\n  soldCb(soldRecord);\n\n  return {\n    percent: optPercent,\n    price: newPrice,\n    costPrice: costPrice,\n    position: newPostion,\n    earnRate: newEarnRate,\n  };\n}\n\n/**\n * 初始值\n */\nconst initValue = {\n  /**\n   * 成本\n   */\n  costPrice: 10,\n  /**\n   * 仓位\n   */\n  position: 1000,\n  /**\n   * 盈亏比\n   */\n  earnRate: 0,\n};\n\nconst options = {\n  /**\n   * 上涨概率\n   */\n  p: 0.3,\n  /**\n   * 模拟轮数\n   */\n  cycle: 30,\n  /**\n   * 上涨时配置\n   */\n  up: {\n    threshold: 0.02,\n    position: -500,\n  },\n  /**\n   * 下跌时配置\n   */\n  down: {\n    threshold: -0.02,\n    position: 100000,\n  },\n};\n\nconst result = simulate(initValue, options);\n\nexport { result };\n// console.log(analyze(result));\n","import React, { useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport LineChart from '../Chart/LineChart';\nimport { simulate } from '../../utils/simulate';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    width: '100%',\n    height: '100%',\n  },\n}));\n\nfunction SimulateCard(props) {\n  const [lineSource, setuLineSource] = useState([]);\n  const classes = useStyles();\n  const { stock, options } = props;\n\n  useEffect(() => {\n    const simulateInitData = {\n      costPrice: stock.costPrice,\n      position: stock.position,\n      earnRate: 0,\n    };\n    const simulateResult = simulate(simulateInitData, options);\n    const { onlineRecords = [] } = simulateResult;\n    const lineSource = [];\n\n    onlineRecords.forEach((v, idx) => {\n      lineSource.push({\n        x: idx,\n        y: v.earnRate,\n        type: '预期收益',\n      });\n      lineSource.push({\n        x: idx,\n        y: (v.price || simulateInitData.costPrice) / simulateInitData.costPrice - 1,\n        type: '市场收益',\n      });\n    });\n\n    setuLineSource(lineSource);\n  }, [props.options, props.update]);\n\n  return (\n    <div className={`simulate-card ${classes.root}`}>\n      <LineChart data={{ source: lineSource }} width=\"100%\" height=\"100%\" />\n    </div>\n  );\n}\n\nexport default React.memo(SimulateCard);\n","import React, { useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\nimport IconButton from '@material-ui/core/IconButton';\nimport TextField from '@material-ui/core/TextField';\nimport SettingsIcon from '@material-ui/icons/Settings';\n\nconst useStyles = makeStyles((theme) => ({\n  button: {\n    color: '#888',\n    textTransform: 'uppercase',\n    fontSize: 15,\n  },\n  row: {\n    display: 'flex',\n    alignItems: 'center',\n    flexWrap: 'wrap',\n  },\n  center: {\n    textAlign: 'center',\n    '& input': {\n      textAlign: 'center',\n    },\n  },\n  mediumWidth: {\n    width: 80,\n  },\n  tips: {\n    fontSize: 14,\n  },\n}));\n\nconst Transition = React.forwardRef(function Transition(props, ref) {\n  return <Slide direction=\"up\" ref={ref} {...props} />;\n});\n\nexport default function SimulateSetting(props) {\n  const classes = useStyles();\n  const [values, setValues] = useState({});\n  const [open, setOpen] = useState(false);\n\n  useEffect(() => {\n    setValues(props.options);\n  }, [props.options]);\n\n  const handleInputChange = (e, key) => {\n    setValues({\n      ...values,\n      [key]: e.target.value,\n    });\n  };\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleConfirm = () => {};\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    setOpen(false);\n    props.onConfirm && props.onConfirm(values);\n  };\n\n  return (\n    <React.Fragment>\n      <IconButton aria-label=\"setting\" onClick={handleClickOpen} className={classes.button}>\n        <SettingsIcon className={classes.icon} />\n      </IconButton>\n      <Dialog\n        open={open}\n        TransitionComponent={Transition}\n        keepMounted\n        onClose={handleClose}\n        aria-labelledby=\"alert-dialog-slide-title\"\n        aria-describedby=\"alert-dialog-slide-description\"\n      >\n        <form onSubmit={handleSubmit}>\n          <DialogTitle id=\"alert-dialog-slide-title\">模拟设置</DialogTitle>\n          <DialogContent>\n            {/* <DialogContentText id=\"alert-dialog-slide-description\" className={classes.tips}>\n              你可以通过导入JSON来快速初始化你的持仓数据。该操作会覆盖现有数据，请谨慎操作。\n            </DialogContentText> */}\n            <div className={classes.row}>\n              设置上涨概率为\n              <TextField\n                required\n                id=\"p\"\n                placeholder=\"0到1之间\"\n                type=\"number\"\n                value={values.p}\n                onChange={(e) => handleInputChange(e, 'p')}\n                InputProps={{\n                  className: classes.center,\n                  min: 0,\n                  max: 1,\n                }}\n              />\n            </div>\n            <div className={classes.row}>\n              日涨幅下跌\n              <TextField\n                required\n                id=\"down_threshold\"\n                type=\"number\"\n                size=\"small\"\n                className={classes.mediumWidth}\n                value={values['down_threshold']}\n                onChange={(e) => handleInputChange(e, 'down_threshold')}\n                InputProps={{\n                  endAdornment: <InputAdornment position=\"start\">%</InputAdornment>,\n                  className: classes.center,\n                }}\n              />\n              加仓\n              <TextField\n                required\n                id=\"down_position\"\n                type=\"number\"\n                size=\"small\"\n                className={classes.mediumWidth}\n                value={values.down_position}\n                onChange={(e) => handleInputChange(e, 'down_position')}\n                InputProps={{\n                  endAdornment: <InputAdornment position=\"start\">手</InputAdornment>,\n                  className: classes.center,\n                }}\n              />\n            </div>\n            <div className={classes.row}>\n              日涨幅上涨\n              <TextField\n                required\n                id=\"up_threshold\"\n                type=\"number\"\n                value={values.up_threshold}\n                onChange={(e) => handleInputChange(e, 'up_threshold')}\n                InputProps={{\n                  endAdornment: <InputAdornment position=\"start\">%</InputAdornment>,\n                  className: classes.center,\n                }}\n                className={classes.mediumWidth}\n              />\n              减仓\n              <TextField\n                required\n                id=\"up_position\"\n                label=\"\"\n                type=\"number\"\n                className={classes.mediumWidth}\n                value={values.up_position}\n                onChange={(e) => handleInputChange(e, 'up_position')}\n                InputProps={{\n                  endAdornment: <InputAdornment position=\"start\">手</InputAdornment>,\n                  className: classes.center,\n                }}\n              />\n            </div>\n            <div className={classes.row}>\n              模拟\n              <TextField\n                required\n                id=\"cycle\"\n                type=\"number\"\n                value={values.cycle}\n                onChange={(e) => handleInputChange(e, 'cycle')}\n                InputProps={{\n                  endAdornment: <InputAdornment position=\"start\">交易日</InputAdornment>,\n                  className: classes.center,\n                }}\n              />\n            </div>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={handleClose} color=\"primary\">\n              取消\n            </Button>\n            <Button onClick={handleConfirm} color=\"primary\" type=\"submit\">\n              确定\n            </Button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </React.Fragment>\n  );\n}\n","import React, { Component } from 'react';\nimport ReversalCard from './ReversalCard';\nimport SimulateCard from './SimulateCard';\nimport { toMultiple, formatSimulateValues } from '../utils/common';\nimport TrendingUpIcon from '@material-ui/icons/TrendingUp';\nimport LoopIcon from '@material-ui/icons/Loop';\nimport { Button } from '@material-ui/core';\nimport SimulateSetting from './SimulateCard/SimulateSetting';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport './StockItem.scss';\n\nfunction caclClass(number) {\n  if (number > 0) {\n    return 'red';\n  } else if (number < 0) {\n    return 'green';\n  } else {\n    return 'default';\n  }\n}\n\nfunction calcLink(data) {\n  const bcLinkData = [\n    { type: 0, eq: data.bcFn, color: '#13AD13' },\n    { type: 1000, window: ['-200', '1500', '0', String(Math.abs(data.earnRate * (1.5).toFixed(2)))] },\n  ];\n  const jcLinkData = [\n    { type: 0, eq: data.jcFn, color: '#ED1717' },\n    { type: 1000, window: ['-100', '500', '0', String(Math.abs(data.earnRate * (1.5).toFixed(2)))] },\n  ];\n  const linkData = data.costPrice > data.price ? bcLinkData : jcLinkData;\n  // replace这一步是因为绘图网站http://fooplot.com的base64算法使用-代替=填充\n  const base64 = window.btoa(JSON.stringify(linkData)).replace(/=/g, '-');\n\n  return `http://fooplot.com/#${base64}`;\n}\n\nexport default class StockItem extends Component {\n  state = {\n    reversal: false,\n    simulateOptions: {\n      p: 0.6,\n      cycle: 30,\n      up_threshold: 2,\n      up_position: 500,\n      down_threshold: 2,\n      down_position: 500,\n    },\n  };\n\n  // 翻转卡片\n  handleRevesalClick = () => {\n    this.setState({\n      reversal: !this.state.reversal,\n    });\n  };\n\n  // 点击补仓函数跳转至函数绘图网站\n  handleLinkClick(data) {\n    const url = calcLink(data);\n    window.open(url, data.name);\n  }\n\n  // 修改模拟参数\n  handleConfirm = (values) => {\n    this.setState({\n      simulateOptions: values,\n    });\n  };\n\n  // 刷新模拟数据\n  handleUpdateSimulate = () => {\n    this.setState({\n      update: new Date().valueOf(),\n    });\n  };\n\n  render() {\n    const { data, summary } = this.props;\n    // 每股收益\n    const earningsPerShare = data.price - data.costPrice;\n    const earningCls = caclClass(earningsPerShare);\n\n    // 计算达到预期亏损的补仓建议\n    let { advice } = data;\n\n    // 所有持仓最大亏损比绝对值\n    const maxAbsEarnRate = summary.earn.maxAbsRate;\n    // 当前持仓亏损比绝对值\n    const currentAbsEarnRate = Math.abs(data.earnRate);\n    // 参考值，以此值作为基础值来计算百分比\n    const baseRate = toMultiple(maxAbsEarnRate, 0.05);\n    // 占比\n    const inPercent = (currentAbsEarnRate / baseRate).toFixed(2);\n\n    const simulateOpts = formatSimulateValues(this.state.simulateOptions);\n    const style = {\n      flex: inPercent,\n    };\n\n    return (\n      <div className={`stock-item ${earningCls}`}>\n        <div className=\"title-box\">\n          <h3>{data.name || '无名股票'}</h3>\n          <div className=\"more-tools\">\n            <Button endIcon={!this.state.reversal && <TrendingUpIcon />} onClick={this.handleRevesalClick}>\n              {this.state.reversal ? '返回' : '模拟走势'}\n            </Button>\n            {this.state.reversal && (\n              <IconButton aria-label=\"setting\" onClick={this.handleUpdateSimulate}>\n                <LoopIcon />\n              </IconButton>\n            )}\n\n            {this.state.reversal && (\n              <SimulateSetting options={this.state.simulateOptions} onConfirm={this.handleConfirm} />\n            )}\n          </div>\n        </div>\n        <ReversalCard\n          update={this.state.update}\n          on={this.state.reversal}\n          reversal={\n            <SimulateCard\n              update={this.state.update}\n              stock={{\n                position: data.position,\n                costPrice: data.costPrice,\n                earnRate: data.earnRate,\n              }}\n              options={simulateOpts}\n            />\n          }\n        >\n          <div className=\"stock-spc-item earn-rate-item\">\n            <label className=\"stock-item-label\">盈亏比</label>\n            <span className={`stock-item-value ${earningCls} weight`} style={style}>\n              {(data.earnRate * 100).toFixed(3)}%\n            </span>\n          </div>\n          <div className=\"row\">\n            <div className=\"cell stock-spc-item\">\n              <label className=\"stock-item-label\">总盈亏</label>\n              <span className={`stock-item-value ${earningCls} earn-amount`}>\n                {(data.earnRate * data.costPrice * data.position).toFixed(2)}\n              </span>\n            </div>\n            <div className=\"cell stock-spc-item\">\n              <label className=\"stock-item-label\">市值</label>\n              <span className={`stock-item-value`}>{(data.costPrice * data.position).toFixed(2)}</span>\n            </div>\n          </div>\n\n          <div className=\"white-blank\"></div>\n          <div className=\"row\">\n            <div className=\"cell stock-spc-item\">\n              <label className=\"stock-item-label\">当日浮{data.percent >= 0 ? '盈' : '亏'}</label>\n              <span className={`stock-item-value ${caclClass(data.percent)} weight`}>\n                {(data.costPrice * data.position * data.percent).toFixed(2)}\n              </span>\n            </div>\n            <div className=\"cell stock-spc-item\">\n              <label className=\"stock-item-label\">成本</label>\n              <span className=\"stock-item-value\">{data.costPrice}</span>\n            </div>\n          </div>\n          <div className=\"row\">\n            <div className=\"cell stock-spc-item\">\n              <label className=\"stock-item-label\">现价</label>\n              <span className=\"stock-item-value\">{data.price}</span>\n            </div>\n            <div className=\"cell stock-spc-item\">\n              <label className=\"stock-item-label\">持仓</label>\n              <span className=\"stock-item-value\">{data.position}</span>\n            </div>\n          </div>\n\n          <div className={`stock-spc-item percent-item`}>\n            <label className=\"stock-item-label\">当日{data.percent >= 0 ? '涨' : '跌'}幅</label>\n            <span className={`stock-item-value weight ${caclClass(data.percent)}`}>\n              {(data.percent * 100).toFixed(2)}%\n              <i className=\"percent-bar\" style={{ width: `${Math.abs(data.percent * 1000)}%` }} />\n            </span>\n          </div>\n\n          <div className=\"white-blank\"></div>\n\n          <div className=\"stock-spc-item\">\n            <label className=\"stock-item-label\">{earningsPerShare < 0 ? '补仓函数' : '加仓函数'}</label>\n            <span\n              className=\"stock-item-value\"\n              onClick={() => {\n                this.handleLinkClick(data);\n              }}\n            >\n              <span className=\"link\">查看</span>\n              {/* <small className=\"text-weak\">(灰色曲线为函数的导数图)</small> */}\n            </span>\n          </div>\n\n          <div className=\"white-blank\"></div>\n\n          {advice.x && (\n            <div className=\"stock-spc-item advice-item\">\n              <label className=\"stock-item-label\">建议</label>\n              <span className=\"stock-item-value advice-value\">\n                目前您的亏损超过了{Math.floor(Math.abs(data.earnRate) * 100)}%。建议补仓\n                <b className=\"mark\">{(advice.x / 100) >> 0}</b>\n                手， 需要资金\n                <b className=\"mark\">¥{Math.ceil(data.price * advice.x)}</b>, 可将亏损降至\n                <b className=\"mark\">{(advice.approValue * 100).toFixed(3)}%</b>。\n              </span>\n            </div>\n          )}\n        </ReversalCard>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport IconButton from '@material-ui/core/IconButton';\nimport DeleteIcon from '@material-ui/icons/Delete';\n\nimport './PositionItem.scss';\n\nconst SCHEMA = {\n  name: {\n    required: false,\n  },\n  symbol: {\n    required: true,\n  },\n  costPrice: {\n    required: true,\n    min: 1,\n  },\n  position: {\n    required: true,\n    min: 100,\n  },\n};\n\nexport default class PostionItem extends Component {\n  state = {\n    stock: {},\n  };\n\n  // handle input item change\n  handleInputChange = (key, e) => {\n    const { stock } = this.state;\n\n    this.setState(\n      {\n        stock: {\n          ...stock,\n          [key]: String(e.target.value).replace(/\\s/g, ''),\n        },\n      },\n      () => {\n        const { onComplete } = this.props;\n        const isValid = this.validateShema();\n\n        isValid && onComplete({ ...this.state.stock });\n      },\n    );\n  };\n\n  validateShema = () => {\n    const { stock } = this.state;\n\n    return Object.keys(SCHEMA).every(schemaKey => {\n      const rule = SCHEMA[schemaKey];\n\n      if (stock[schemaKey]) {\n        return rule.required ? stock[schemaKey] : true;\n      } else {\n        return !rule.required;\n      }\n    });\n  };\n\n  onDelete = e => {\n    const { onDelete, data } = this.props;\n\n    onDelete && onDelete(data, e);\n  };\n\n  render() {\n    const { edit = false, data = {} } = this.props;\n    return (\n      <div className=\"postion-item-box\">\n        {edit ? (\n          <div className=\"position-edit-item\">\n            <div className=\"col stock-name\">\n              <input\n                type=\"text\"\n                defaultValue={data.name || ''}\n                placeholder=\"[可填]名称\"\n                onChange={e => this.handleInputChange('name', e)}\n              />\n            </div>\n            <div className=\"col stock-code\">\n              <input\n                type=\"text\"\n                defaultValue={data.symbol || ''}\n                placeholder=\"* 代码\"\n                onChange={e => this.handleInputChange('symbol', e)}\n              />\n            </div>\n            <div className=\"col stock-cost-price\">\n              <input\n                type=\"number\"\n                defaultValue={data.costPrice || ''}\n                placeholder=\"* 成本\"\n                onChange={e => this.handleInputChange('costPrice', e)}\n              />\n            </div>\n            <div className=\"col stock-postion\">\n              <input\n                type=\"number\"\n                defaultValue={data.position || ''}\n                placeholder=\"* 持仓(股)\"\n                onChange={e => this.handleInputChange('position', e)}\n              />\n            </div>\n          </div>\n        ) : (\n          <div className=\"position-show-item\">\n            <div className=\"col stock-name\">{data.name || ''}</div>\n            <div className=\"col stock-code\">{data.symbol}</div>\n            <div className=\"col stock-cost-price\">{data.costPrice}</div>\n            <div className=\"col stock-postion\">\n              <span>{data.position}</span>\n              <IconButton className=\"delete-btn\" aria-label=\"delete\" size=\"small\"  onClick={this.onDelete} >\n                <DeleteIcon size=\"small\" />\n              </IconButton>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport AddIcon from '@material-ui/icons/Add';\n\nimport './PositionItem.scss';\n\nconst SCHEMA = {\n  name: {\n    required: false,\n  },\n  symbol: {\n    required: true,\n  },\n  costPrice: {\n    required: true,\n    min: 1,\n  },\n  position: {\n    required: true,\n    min: 100,\n  },\n};\n\nexport default class AddPostionItem extends Component {\n  state = {\n    stock: {},\n  };\n\n  // handle input item change\n  handleInputChange = (key, e) => {\n    const { stock } = this.state;\n\n    this.setState(\n      {\n        stock: {\n          ...stock,\n          [key]: String(e.target.value).replace(/\\s/g, ''),\n        },\n      },\n      () => {\n        const { onComplete } = this.props;\n        const isValid = this.validateShema();\n\n        isValid && onComplete({ ...this.state.stock });\n      },\n    );\n  };\n\n  validateShema = () => {\n    const { stock } = this.state;\n\n    return Object.keys(SCHEMA).every(schemaKey => {\n      const rule = SCHEMA[schemaKey];\n\n      if (stock[schemaKey]) {\n        return rule.required ? stock[schemaKey] : true;\n      } else {\n        return !rule.required;\n      }\n    });\n  };\n\n  handleAdd = () => {\n    const { onAdd, stocks = [] } = this.props;\n    const { stock } = this.state;\n    const isValid = this.validateShema();\n\n    const isExitStock = stocks.some(v => String(v.symbol) === stock.symbol);\n\n    if (isExitStock) {\n      alert('该股票已存在了，请不要重复添加');\n    } else if (isValid) {\n      onAdd && onAdd({ ...stock });\n      this.setState({\n        stock: {},\n      });\n    } else {\n      alert('请把上方的数据填写完整，再添加新的一条～');\n    }\n  };\n\n  render() {\n    const { stock } = this.state;\n\n    return (\n      <div className=\"postion-item-box\">\n        <div className=\"position-edit-item add-position-item\">\n          {/* <div className=\"col stock-name\">\n            <input\n              type=\"text\"\n              value={stock.name || ''}\n              placeholder=\"[可填]名称\"\n              onChange={e => this.handleInputChange('name', e)}\n            />\n          </div> */}\n          <div className=\"col stock-code\">\n            <TextField\n              required\n              type=\"text\"\n              label=\"股票代码\"\n              defaultValue={stock.symbol || ''}\n              onChange={e => this.handleInputChange('symbol', e)}\n            />\n          </div>\n          <div className=\"col stock-cost-price\">\n            <TextField\n              required\n              type=\"number\"\n              label=\"成本\"\n              defaultValue={stock.costPrice || ''}\n              onChange={e => this.handleInputChange('costPrice', e)}\n            />\n          </div>\n          <div className=\"col stock-postion\">\n            <TextField\n              required\n              type=\"number\"\n              label=\"持仓(股)\"\n              defaultValue={stock.position || ''}\n              onChange={e => this.handleInputChange('position', e)}\n            />\n          </div>\n        </div>\n        <div className=\"add-line\">\n          <div className=\"add-line-btn\" onClick={this.handleAdd}>\n            <Button\n              fullWidth\n              variant=\"text\"\n              color=\"default\"\n              startIcon={ <AddIcon />}\n            >\n              添加\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport PositionItem from './PositionItem';\nimport AddPostionItem from './AddPostionItem';\n\nimport './Position.scss';\n\nexport default class Position extends Component {\n  componentDidMount() {\n    const { stocks = [], core } = this.props;\n\n    this.stocks = stocks;\n    core && core(this);\n  }\n\n  handleComplete = (data, index) => {\n    const { stocks = [], onItemComplete } = this.props;\n    const stocksMap = stocks.reduce((map, stock, index) => {\n      stock.index = index;\n      map[stock.symbol] = stock;\n      return map;\n    }, {});\n\n    const sameCodeStocks = Object.values(stocksMap).filter(v => String(v.symbol) === String(data.symbol));\n\n    if (sameCodeStocks.length > 1) {\n      alert('该股票已存在了，你可以点击修改~');\n    } else {\n      data.index = index;\n      stocksMap[data.symbol] = data;\n\n      this.stocks = Object.values(stocksMap).sort((a, b) => a.index - b.index);\n      onItemComplete && onItemComplete(data, this.stocks);\n    }\n  };\n\n  // 点击添加一行按钮\n  handleAddRowClick = (addStockItem) => {\n    const { onAdd } = this.props;\n\n    onAdd && onAdd(this.stocks);\n  };\n\n  onDelete = data => {\n    const { onDelete } = this.props;\n\n    onDelete && onDelete(data);\n  };\n\n  render() {\n    const { stocks } = this.props;\n\n    return (\n      <div className=\"stocks-list-wrap\">\n        <div className=\"postion-list-header\">\n          <div className=\"th\">名称</div>\n          <div className=\"th\">代码</div>\n          <div className=\"th\">成本</div>\n          <div className=\"th\">持仓</div>\n        </div>\n        {stocks.map((stock, index) => (\n          <PositionItem\n            key={stock.symbol}\n            data={stock}\n            onComplete={data => this.handleComplete(data, index)}\n            onDelete={this.onDelete}\n          />\n        ))}\n        {/*添加行 */}\n        <AddPostionItem\n          key={stocks.length}\n          stocks={stocks}\n          onComplete={data => this.handleComplete(data, stocks.length)}\n          onAdd={this.handleAddRowClick}\n        />\n      </div>\n    );\n  }\n}\n","import React from 'react';\n\nexport const stockInitData = {\n  showPostion: false,\n  isEdit: false,\n};\n\nexport function stockInit(initialData) {\n  return { ...stockInitData, ...initialData };\n}\n\nexport function stockReducer(state, action) {\n  switch (action.type) {\n    case 'ADD':\n      return { ...state, showPostion: true, isEdit: true };\n    case 'EDIT':\n      return { ...state, showPostion: true, isEdit: true };\n    case 'SAVE':\n      return { ...state, showPostion: false, isEdit: false };\n    case 'RESET':\n      return { ...state, showPostion: false, isEdit: false };\n    case 'INIT':\n      return stockInit(action.payload);\n    case 'SET':\n      return { ...state, ...action.payload };\n    case 'SET_SUMMARY': {\n      return { ...state, summary: { ...action.payload } };\n    }\n    default:\n      return state;\n  }\n}\n\nexport const StockContext = React.createContext(stockInitData);\n","import React, { useState, useEffect, useContext } from 'react';\nimport StockItem from './StockItem';\nimport { formatToLocalStocks } from '../utils/common';\nimport Position from './Position';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport PlaylistAddIcon from '@material-ui/icons/PlaylistAdd'\nimport PlaylistAddCheckIcon from '@material-ui/icons/PlaylistAddCheck'\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Select from '@material-ui/core/Select';\nimport { StockContext } from '../reducers';\n\nimport './Stock.scss';\n\nconst useStyles = makeStyles((theme) => ({\n  saveButton: {\n    color: '#fff',\n    fontSize: 16,\n  },\n  editButton: {\n    color: '#555',\n    fontSize: 15,\n  },\n  sortTool: {\n    fontSize: 14,\n  }\n}));\nconst TYPE_MAP = {\n  asce: 1,\n  desc: -1,\n};\n\nexport default function StockList(props) {\n  const classes = useStyles();\n  const { dispatch } = props;\n  const [stocks, setStocks] = useState([]);\n  const [editStocks, setEditStocks] = useState([]);\n  const [sort, setSort] = useState('default');\n  const [key, type] = sort.split(':');\n  let sortedStocks = [...stocks];\n\n  const stockState = useContext(StockContext);\n\n  useEffect(() => {\n    setStocks(props.list);\n    setEditStocks(props.list);\n  }, [props.list]);\n\n  // 点击添加按钮\n  const handleAdd = stocks => {\n    setEditStocks(stocks);\n  };\n\n  // 持仓添加/修改改变\n  const handlePostionComplete = (data, stocks) => {\n    console.log('编辑', data, stocks);\n  };\n\n  // 保存/修改持仓\n  const hanldPostionClick = type => {\n    if(type === 'edit') {\n      dispatch({\n        type: 'SET',\n        payload: {\n          showPostion: !stockState.showPostion,\n          isEdit: true,\n        },\n      });\n    }\n    if (type === 'save') {\n      const localStocks = formatToLocalStocks(StockList.core.stocks);\n      localStorage.setItem('stocks', JSON.stringify(localStocks));\n      props.onSave && props.onSave();\n      dispatch({ type: 'SAVE' });\n    }\n  };\n\n  // 排序选择权改变\n  const handleSortChange = e => {\n    setSort(e.target.value);\n  };\n\n  // 处理删除持仓\n  const handleDletePosition = data => {\n    const filterStocks = StockList.core.stocks.filter(v => String(v.symbol) !== String(data.symbol));\n\n    setEditStocks([...filterStocks]);\n    StockList.core.stocks = filterStocks;\n  };\n\n  if (key === 'default') {\n    sortedStocks = stocks || [];\n  } else {\n    const ratio = TYPE_MAP[type] || 1;\n    sortedStocks = stocks.sort((s1, s2) => (s1[key] - s2[key]) * ratio);\n  }\n\n  const { showPostion, summary } = stockState;\n\n  return (\n    <div className=\"stock-list-wrap\">\n      <div className=\"tools-box\">\n        <div className=\"sort-tool\">\n          <Select onChange={handleSortChange} defaultValue=\"default\" className={classes.sortTool}>\n            <MenuItem value=\"default\">默认排序</MenuItem>\n            <MenuItem value=\"earnRate:asce\">盈亏从低到高⬆</MenuItem>\n            <MenuItem value=\"earnRate:desc\">盈亏从高到低⬇</MenuItem>\n            <MenuItem value=\"percent:asce\">涨幅从低到高⬆</MenuItem>\n            <MenuItem value=\"percent:desc\">涨幅从高到低⬇</MenuItem>\n          </Select>\n        </div>\n        <div className=\"position-tool\" onClick={() => hanldPostionClick(showPostion ? 'save' : 'edit')}>\n          {\n            showPostion ? (\n              <Button\n                className={classes.saveButton}\n                variant=\"contained\"\n                endIcon={ <PlaylistAddCheckIcon />}\n                color=\"primary\"\n                size=\"small\"\n              >\n                保存\n              </Button>\n            ): (\n              <Button\n                className={classes.editButton}\n                variant=\"text\"\n                size=\"large\"\n                endIcon={ <PlaylistAddIcon />}\n              >\n                {`${stocks.length <= 0 ? '添加' : '修改'}持仓`}\n              </Button>\n            )\n          }\n        </div>\n      </div>\n      {showPostion && (\n        <Position\n          core={core => (StockList.core = core)}\n          stocks={editStocks || stocks || []}\n          onItemComplete={handlePostionComplete}\n          onAdd={handleAdd}\n          onDelete={handleDletePosition}\n        />\n      )}\n      <div className=\"stock-list flow\">\n        {sortedStocks.map(stock => (\n          <StockItem key={stock.symbol} data={stock} summary={summary} />\n        ))}\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport Typography from '@material-ui/core/Typography';\nimport StockList from './StockList';\n\nconst useStyles = makeStyles(theme => ({\n  heading: {\n    fontSize: theme.typography.pxToRem(15),\n    flexBasis: '33.33%',\n    flexShrink: 0,\n  },\n  panel: {\n    padding: '8px 18px 24px',\n  }\n}));\n\nexport default function StockPanel(props) {\n  const classes = useStyles();\n  const [expanded, setExpanded] = React.useState('panel2');\n\n  const handleChange = panel => (event, isExpanded) => {\n    setExpanded(isExpanded ? panel : false);\n  };\n\n  const { map, list, onSave, dispatch } = props;\n\n  return (\n    <ExpansionPanel expanded={expanded === 'panel2'} onChange={handleChange('panel2')}>\n      <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />} aria-controls=\"panel2bh-content\" id=\"panel2bh-header\">\n        <Typography className={classes.heading}>持仓</Typography>\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails className={classes.panel}>\n        <StockList map={map} list={list} onSave={onSave} dispatch={dispatch} />\n      </ExpansionPanelDetails>\n    </ExpansionPanel>\n  );\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport Typography from '@material-ui/core/Typography';\n\nconst useStyles = makeStyles(theme => ({\n  panel: {\n    display: 'block',\n  },\n  detial: {\n    display: 'block',\n  },\n  heading: {\n    fontSize: theme.typography.pxToRem(15),\n    flexBasis: '33.33%',\n    flexShrink: 0,\n  },\n  defaultColor: {\n    color: '#888',\n  },\n}));\n\nexport default function SummaryPanel(props) {\n  const classes = useStyles();\n  const [expanded, setExpanded] = React.useState('panel1');\n\n  const handleChange = panel => (event, isExpanded) => {\n    setExpanded(isExpanded ? panel : false);\n  };\n\n  const { summary = {}, list = [] } = props;\n\n  return (\n    <ExpansionPanel className={classes.haha} expanded={expanded === 'panel1'} onChange={handleChange('panel1')}>\n      <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />} aria-controls=\"panel2bh-content\" id=\"panel2bh-header\">\n        <Typography className={classes.heading}>总览</Typography>\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails className={classes.detial}>\n        {list.length <= 0 ? (\n          <React.Fragment>\n            <Typography display=\"inline\" color=\"error\">\n              请先添加持仓，才能查看总览。\n            </Typography>\n            <Typography display=\"inline\" className={classes.defaultColor} variant=\"body1\">\n              或者点击上方的RESET按钮,参看示例数据。\n            </Typography>\n          </React.Fragment>\n        ) : (\n          <React.Fragment>\n            <Typography display=\"block\" paragraph>\n              <span>你持仓的总市值为{summary.marketValue}。</span>\n              <span>总成本为{summary.costValue}。</span>\n              <span>\n                目前{summary.earnMoney >= 0 ? '盈利' : '亏损'} {Math.abs(summary.earnMoney)}元。\n              </span>\n              <span>盈亏率：{(summary.earnRate * 100).toFixed(2)}%。</span>\n            </Typography>\n            {Object.keys(summary.advice || {}).length > 0 && (\n              <Typography display=\"block\" color=\"error\">\n                建议账户保留流动资金{summary.advice?.hotMoney}元，以应对风险。\n              </Typography>\n            )}\n          </React.Fragment>\n        )}\n      </ExpansionPanelDetails>\n    </ExpansionPanel>\n  );\n}\n","import React, { useEffect, useState, useReducer, useRef } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport Reset from './components/Reset';\nimport Import from './components/Import';\nimport StockPanel from './components/StockPanel';\nimport SummaryPanel from './components/SummaryPanel';\nimport { API_BASE_URL, UPDATE_INTERVAL } from './constants';\nimport { getStockCodes, calcStockSummary, initData, resetData, mergeStocks } from './utils/common';\nimport { stockReducer, stockInitData, StockContext } from './reducers';\n\nconst $ = window.$;\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    width: '100%',\n  },\n  header: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginTop: 20,\n    marginBottom: 20,\n\n    '& .title-box': {\n      marginTop: 0,\n      marginBottom: 0,\n    },\n    '& .import-tool': {\n      cursor: 'pointer',\n      color: '#888',\n      fontSize: 14,\n    },\n  },\n  snackbar: {\n    '& .MuiSnackbarContent-root': {\n      padding: '2px 16px',\n    },\n    '&.error .MuiSnackbarContent-root': {\n      backgroundColor: 'rgb(253, 236, 234)',\n      color: 'rgb(97, 26, 21)',\n    },\n    '&.warning .MuiSnackbarContent-root': {\n      backgroundColor: 'rgb(255, 244, 229)',\n      color: 'rgb(102, 60, 0)',\n    },\n    '&.success .MuiSnackbarContent-root': {\n      backgroundColor: 'rgb(237, 247, 237)',\n      color: 'rgb(30, 70, 32)',\n    },\n  },\n}));\n// 定时器\nlet timer = null;\n\nexport default function DashBord() {\n  const classes = useStyles();\n  const [stocksMap, setStocksMap] = useState({});\n  const [stockList, setStockList] = useState([]);\n  const [tips, setTips] = useState({ open: false, message: '' });\n  const [summary, setSummary] = useState({});\n  const [stockState, dispatch] = useReducer(stockReducer, stockInitData);\n  const stockRef = useRef(stockState);\n\n  useEffect(() => {\n    initData();\n    fetchStocks();\n\n    timer = setInterval(() => {\n      fetchStocks();\n    }, UPDATE_INTERVAL);\n    return () => {\n      clearInterval(timer);\n    };\n  }, []);\n\n  // 获取股票信息\n  function fetchStocks(options = {}) {\n    const { success, fail } = options;\n    const localStockStr = localStorage.getItem('stocks');\n    const STOCKS = localStockStr ? JSON.parse(localStockStr) : [];\n    const stockCodes = STOCKS.map((stock) => String(stock.symbol));\n    const { isEdit } = stockRef.current;\n\n    if (STOCKS.length <= 0) {\n      setStocksMap({});\n      setStockList([]);\n      setSummary({});\n      return;\n    }\n\n    $ &&\n      !isEdit &&\n      $.ajax({\n        type: 'GET',\n        dataType: 'jsonp',\n        url: `${API_BASE_URL}${getStockCodes(stockCodes).join(',')}`,\n        success: function (serverData, status, xhr) {\n          const stockList = mergeStocks(serverData);\n          const summary = calcStockSummary(stockList);\n          dispatch({\n            type: 'SET_SUMMARY',\n            payload: summary,\n          });\n          setStocksMap(serverData);\n          setStockList(stockList);\n          setSummary(summary);\n          success && success();\n        },\n        error: function (e) {\n          console.error('请求接口错误');\n          fail && fail();\n        },\n      });\n  }\n\n  function handleSave() {\n    stockRef.current = { ...stockState, showPostion: false, isEdit: false };\n\n    fetchStocks({\n      success: () => {\n        setTips({\n          status: 'success',\n          open: true,\n          message: '保存成功',\n        });\n      },\n      fail: () => {\n        setTips({\n          status: 'error',\n          open: true,\n          message: '保存失败',\n        });\n      },\n    });\n  }\n\n  function handleTipClose() {\n    setTips({\n      status: 'default',\n      open: false,\n      message: '',\n    });\n  }\n\n  function handleResetConfirm() {\n    dispatch({\n      type: 'SAVE',\n    });\n    stockRef.current = { ...stockState, showPostion: false, isEdit: false };\n    resetData();\n    fetchStocks({\n      success: () => {\n        setTips({\n          status: 'success',\n          open: true,\n          message: '重置成功',\n        });\n      },\n      fail: () => {\n        setTips({\n          status: 'error',\n          open: true,\n          message: '重置失败',\n        });\n      },\n    });\n  }\n\n  function handleImportConfirm(json) {\n    if (json) {\n      dispatch({\n        type: 'SAVE',\n      });\n      stockRef.current = { ...stockState, showPostion: false, isEdit: false };\n      resetData(json);\n      fetchStocks({\n        success: () => {\n          setTips({\n            status: 'success',\n            open: true,\n            message: '导入成功',\n          });\n        },\n        fail: () => {\n          setTips({\n            status: 'error',\n            open: true,\n            message: '导入失败',\n          });\n        },\n      });\n    }\n  }\n\n  stockRef.current = stockState;\n\n  return (\n    <StockContext.Provider value={stockState}>\n      <div className={classes.root}>\n        <div className={classes.header}>\n          <h2 className=\"title-box\">\n            STOCK HELPER\n            <Reset onConfirm={handleResetConfirm} />\n          </h2>\n          <div className=\"import-tool\">\n            <Import onConfirm={handleImportConfirm} />\n          </div>\n        </div>\n        <SummaryPanel map={stocksMap} list={stockList} summary={summary} />\n        <StockPanel map={stocksMap} list={stockList} onSave={handleSave} dispatch={dispatch} />\n      </div>\n     \n      <Snackbar\n        className={`${classes.snackbar} ${tips.status}`}\n        anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\n        open={tips.open}\n        onClose={handleTipClose}\n        autoHideDuration={3000}\n        message={tips.message}\n      />\n    </StockContext.Provider>\n  );\n}\n","import React from 'react';\nimport Dashbord from './Dashbord';\nimport { resetData } from './utils/common'\n\nimport './App.scss';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Dashbord />\n    </div>\n  );\n}\n\n/**\n * 容错\n */\nwindow.addEventListener('error', (globalError) => {\n  console.error('addEventListener error', globalError);\n  // const r = window.confirm(`数据错误，将重置数据。\\n${globalError.message}`)\n  // if(r === true) {\n  //   resetData();\n  //   window.location.reload();\n  // }\n});\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport './utils/polyfill';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import Big from 'big.js';\nimport { STOCKS, EXPECT_LOSS_RATE, ADVICE_LOSS_RATE } from '../constants';\n\n// eslint-disable-next-line no-extend-native\nString.prototype.replaceAt = function (index, replacement) {\n  return this.substr(0, index) + replacement + this.substr(index + 1);\n};\n\n// 对股票id进行处理\nexport function getStockCodes(stocks = []) {\n  return stocks.map((code) => {\n    if (isNaN(code[0])) {\n      if (code.toLowerCase().indexOf('us_') > -1) {\n        return code.toUpperCase();\n      } else if (code.indexOf('hk') > -1) {\n        return code;\n      } else {\n        return code.toLowerCase().replace('sz', '1').replace('sh', '0');\n      }\n    } else {\n      return (code[0] === '6' ? '0' : '1') + code;\n    }\n  });\n}\n\n// 生成补仓函数\nexport function genFnForBC(stocks = []) {\n  return stocks.map((stock) => {\n    stock.bcFn = `((${stock.position}+x)${stock.price})/(${stock.costPrice}*${stock.position} + ${stock.price}x)`;\n    return stock;\n  });\n}\n\nexport function soryBy(key, type) {}\n\n/**\n * 根据反比函数公式，求一个最小近似值\n * @param {*} formula 公式，变量为x\n * @param {*} targetValue 目标值\n */\nfunction calcApproximateValue(formula = '', targetValue, options = {}) {\n  const { step = 1, startX = 0, endX, cycleCount = 300 } = options;\n  let realCycleCount = endX ? endX - startX + 1 : cycleCount;\n  let count = 0;\n  let i = 0;\n  let resultMap = {};\n\n  while (count < realCycleCount) {\n    const vX = step + i;\n    const formulaStr = putIntoFormula(formula, 'x', vX);\n    // eslint-disable-next-line no-eval\n    const result = eval(formulaStr);\n    const delta = Math.abs(result - targetValue);\n\n    resultMap[delta] = { x: vX, y: result, times: count };\n    i += step;\n    count++;\n  }\n  const minDelta = Math.min(...Object.keys(resultMap));\n  const approObj = resultMap[minDelta];\n\n  return {\n    formula,\n    x: approObj.x,\n    y: approObj.y,\n    targetValue,\n    approValue: approObj.y,\n    step,\n  };\n}\n\n//格式华\nexport function formatToLocalStocks(stocks = []) {\n  return stocks.map((stock) => ({\n    name: stock.name,\n    symbol: stock.symbol,\n    costPrice: stock.costPrice,\n    position: stock.position,\n  }));\n}\n\n// 初始化数据\nexport function initData() {\n  if (!localStorage.getItem('pageView')) {\n    localStorage.setItem('stocks', JSON.stringify(STOCKS));\n    localStorage.setItem('pageView', 1);\n  } else {\n    const pageView = localStorage.getItem('pageView');\n    localStorage.setItem('pageView', Number(pageView) + 1);\n  }\n}\n\n// 重置数据\nexport function resetData(defaultJson = STOCKS) {\n  localStorage.setItem('stocks', JSON.stringify(defaultJson));\n}\n\n// 合并本地和接口数据\nexport function mergeStocks(serverStocks) {\n  const localStockStr = localStorage.getItem('stocks');\n  const STOCKS = localStockStr ? JSON.parse(localStockStr) : [];\n  const stockMap = Object.values(serverStocks).reduce((sum, stock) => {\n    sum[stock.symbol] = stock;\n    return sum;\n  }, {});\n  // 合并成本价、持仓信息\n  const stocks = STOCKS.map((localStock) => {\n    if (stockMap[localStock.symbol]) {\n      const stockItem = {\n        ...localStock,\n        ...stockMap[localStock.symbol],\n      };\n      // 每股计算的建议信息\n      let advice = {};\n      const { costPrice, price, position } = stockItem;\n\n      if (costPrice > price) {\n        stockItem.bcFn = `1-(${(position * price).toFixed(2)}+${price}x)/(${(costPrice * position).toFixed(\n          2,\n        )}+${price}x)`;\n      } else {\n        stockItem.jcFn = `(${(position * price).toFixed(2)}+${price}x)/(${(costPrice * position).toFixed(\n          2,\n        )}+${price}x)-1`;\n      }\n      stockItem.earnRate = price / costPrice - 1;\n\n      if (stockItem.earnRate < ADVICE_LOSS_RATE) {\n        advice = calcApproximateValue(stockItem.bcFn, -EXPECT_LOSS_RATE, { step: 100 });\n        advice.amount = (advice.x * stockItem.price).toFixed(2);\n      }\n\n      stockItem.advice = advice;\n      return stockItem;\n    } else {\n      return localStock;\n    }\n  });\n\n  return [...stocks];\n}\n\n// 计算持仓汇总信息\nexport function calcStockSummary(stockList) {\n  let summary = {\n    // 市值\n    marketValue: 0,\n    // 成本金额\n    costValue: 0,\n    // 盈亏金额\n    earnMoney: 0,\n    // 平均盈亏率\n    earnRate: 0,\n    // 建议\n    advice: {\n      // 建议流动资金\n      hotMoney: 0,\n    },\n    // 盈亏统计\n    earn: {\n      // 最小盈亏比\n      minRate: 0,\n      // 最大盈亏比\n      maxRate: 0,\n      // 最小盈亏金额\n      minMoney: 0,\n      // 最大盈亏金额\n      maxMoney: 0,\n      // 盈亏比绝对值最大值\n      maxAbsRate: 0,\n    },\n  };\n\n  summary = stockList.reduce((sum, item) => {\n    const adviceAmount = item.advice ? item.advice.amount : 0;\n\n    sum.marketValue = new Big(item.price).times(item.position).plus(sum.marketValue).valueOf();\n\n    sum.costValue = new Big(item.costPrice).times(item.position).plus(sum.costValue).valueOf();\n\n    sum.advice.hotMoney = new Big(sum.advice.hotMoney).plus(Number(adviceAmount || 0)).valueOf();\n\n    return sum;\n  }, summary);\n\n  summary.earnRate = new Big(summary.marketValue).div(summary.costValue).minus(1).toFixed(4).valueOf();\n  summary.earnMoney = new Big(summary.marketValue).minus(summary.costValue).valueOf();\n\n  if (stockList && stockList.length > 0) {\n    const sortedByEarnRateList = stockList.sort((a, b) => a.earnRate - b.earnRate);\n    // 最小收益股票\n    const minRateStock = sortedByEarnRateList[0];\n    // 最大收益股票\n    const maxRateStock = sortedByEarnRateList[sortedByEarnRateList.length - 1];\n\n    summary.earn.minRate = minRateStock.earnRate;\n    summary.earn.maxRate = maxRateStock.earnRate;\n\n    summary.earn.minMoney = (minRateStock.earnRate * minRateStock.costPrice * minRateStock.position).toFixed(2);\n    summary.earn.maxMoney = (maxRateStock.earnRate * maxRateStock.costPrice * maxRateStock.position).toFixed(2);\n\n    summary.earn.maxAbsRate = Math.max(Math.abs(minRateStock.earnRate), Math.abs(maxRateStock.earnRate));\n  }\n\n  return summary;\n}\n\n/**\n * 求一个数的倍数\n *\n * @param n number\n * @param m 最小起倍数\n * @param options\n */\nexport function toMultiple(n, m, options = {}) {\n  let n1 = Number(n);\n  let m1 = Number(m);\n  // 返回值 是向上取整[ceil]，还是向下取整数[floor]\n  const { to = 'ceil' } = options;\n  const times = Math.floor(n1 / m1);\n\n  if (n1 === m1 || n1 % m1 === 0) {\n    return n1;\n  }\n\n  switch (to) {\n    case 'ceil': {\n      return Big(times).plus(1).times(m1).valueOf();\n    }\n    case 'floor': {\n      return Big(times).times(m1).valueOf();\n    }\n    default: {\n      return Big(times).plus(1).times(m1).valueOf();\n    }\n  }\n}\n\n/**\n * 代入变量到公式\n * @param {*} formula 公式\n * @param {*} variableKey 变量key\n * @param {*} variable 代入变量值\n */\nfunction putIntoFormula(formula, variableKey, variable) {\n  const matchs = formula.match(new RegExp(variableKey, 'gi'));\n  let newFormula = formula;\n\n  if (matchs.length) {\n    matchs.forEach(() => {\n      const variableIdx = newFormula.indexOf(variableKey);\n      const prevChart = newFormula[variableIdx - 1];\n      const nextChart = newFormula[variableIdx + 1];\n\n      if (variableIdx > -1) {\n        if (/\\d/.test(prevChart)) {\n          newFormula = newFormula.replaceAt(variableIdx, `*${variable}`);\n        } else if (/\\d/.test(nextChart)) {\n          newFormula = newFormula.replaceAt(variableIdx, `${variable}*`);\n        } else {\n          newFormula = newFormula.replaceAt(variableIdx, `${variable}`);\n        }\n      }\n    });\n  }\n\n  return newFormula;\n}\n\n// 格式化模拟设置\nexport const formatSimulateValues = (values) => {\n  const result = {};\n  Object.keys(values).forEach((key) => {\n    const keySplit = key.split('_');\n\n    if (keySplit.length > 1) {\n      const key0 = keySplit[0];\n      const key1 = keySplit[1];\n\n      if (result[key0]) {\n        result[key0][key1] = values[key];\n      } else {\n        result[key0] = {\n          [key1]: values[key],\n        };\n      }\n    } else {\n      result[key] = values[key];\n    }\n  });\n  result.down.threshold = -result.down.threshold / 100;\n  result.up.threshold = result.up.threshold / 100;\n  result.up.position = -result.up.position;\n  return result;\n};\n","// 第三方股市报价api\nexport const API_BASE_URL = 'https://api.money.126.net/data/feed/';\n\n// 第三方股市财务api\nexport const API_QUOTE_URL = 'https://stock.xueqiu.com/v5/stock/quote.json';\n\n// 刷新间隔（毫秒）\nexport const UPDATE_INTERVAL = 3000;\n\n// 期望承受亏损比率\nexport const EXPECT_LOSS_RATE = -0.06;\n\n// 亏损建议值： 当亏损率为该值，计算建议\nexport const ADVICE_LOSS_RATE = -0.059;\n\n// 持仓股\nexport const STOCKS = [\n  {\n    name: '伊利股份',\n    // 股票代码\n    symbol: '600887',\n    // 成本价\n    costPrice: 30.243,\n    // 仓位，多少股\n    position: 400,\n  },\n  {\n    name: '中国平安',\n    // 股票代码\n    symbol: '601318',\n    // 成本价\n    costPrice: 77.987,\n    // 仓位，多少股\n    position: 200,\n  },\n  {\n    name: '格力电器',\n    // 股票代码\n    symbol: '000651',\n    // 成本价\n    costPrice: 60.625,\n    // 仓位，多少股\n    position: 200,\n  },\n  {\n    name: '东山精密',\n    // 股票代码\n    symbol: '002384',\n    // 成本价\n    costPrice: 28.213,\n    // 仓位，多少股\n    position: 400,\n  },\n  {\n    name: '华天科技',\n    // 股票代码\n    symbol: '002185',\n    // 成本价\n    costPrice: 12.870,\n    // 仓位，多少股\n    position: 100,\n  },\n  {\n    name: '华新水泥',\n    // 股票代码\n    symbol: '600801',\n    // 成本价\n    costPrice: 23.813,\n    // 仓位，多少股\n    position: 400,\n  },\n  {\n    name: '海螺水泥',\n    // 股票代码\n    symbol: '600585',\n    // 成本价\n    costPrice: 51.851,\n    // 仓位，多少股\n    position: 100,\n  },\n];\n"],"sourceRoot":""}