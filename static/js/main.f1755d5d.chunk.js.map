{"version":3,"sources":["shared/math.js","shared/common.js","shared/polyfill/index.js","shared/utils.js","reducers/index.js","components/FloatButtom/index.js","components/BasicLayout/index.js","components/Reset/index.js","components/Import/index.js","shared/TouchEmulator.js","components/Chart/Chart.js","components/Chart/LineChart.js","shared/chart.js","components/SettingPop/index.js","components/StockList/StockItem.js","components/StockList/StockList.js","components/StockList/index.js","components/StockPanel/index.js","components/SummaryPanel/index.js","shared/request/jsonp.js","pages/Dashbord/index.js","constants/tableIcons.js","pages/Positions/index.js","App.js","serviceWorker.js","index.js","reducers/storage.js","constants/index.js"],"names":["excuteExpression","expression","vKey","vVal","matchs","match","RegExp","newExpression","length","forEach","variableIdx","indexOf","prevChart","nextChart","test","replaceAt","eval","getStockCodes","stocks","map","code","isNaN","toLowerCase","toUpperCase","replace","genFnForBC","stock","bcFn","position","price","costPrice","soryBy","calcApproximateValue","formula","targetValue","options","step","startX","endX","cycleCount","realCycleCount","count","i","resultMap","vX","formulaStr","result","delta","Math","abs","x","y","times","minDelta","min","Object","keys","approObj","approValue","formatToLocalStocks","name","symbol","pe","eps","profits","issue","initData","localStorage","getItem","pageView","setItem","Number","JSON","stringify","DEFAULT_STOCKS","resetData","defaultJson","setStocksStorage","mergeStocks","serverStocks","localStocks","getStocksStorage","serverStockMap","values","reduce","sum","localStock","stockItem","advice","toFixed","jcFn","earnRate","ADVICE_LOSS_RATE","EXPECT_LOSS_RATE","amount","filter","v","calcStockSummary","stockList","summary","marketValue","costValue","earnMoney","hotMoney","earn","minRate","maxRate","minMoney","maxMoney","maxAbsRate","item","adviceAmount","Big","plus","valueOf","div","minus","sortedByEarnRateList","sort","a","b","minRateStock","maxRateStock","max","toMultiple","n","m","n1","m1","to","floor","window","String","prototype","index","replacement","this","substr","formatSimulateValues","key","keySplit","split","key0","key1","down","threshold","up","updateStock","newValues","newStocks","calcTargetPrice1","calcTargetPrice2","object","isEmpty","obj","Array","isArray","toString","call","initState","stocksMap","_stocks","showPostion","isEdit","reducers","state","action","type","payload","targetIdx","_newStocks","find","Context","React","createContext","FloatButton","history","useHistory","useState","anchorEl","setAnchorEl","open","Boolean","handleClick","push","Fab","color","aria-label","aria-controls","aria-haspopup","onClick","e","currentTarget","Menu","id","keepMounted","onClose","TransitionComponent","Fade","MenuItem","useStyles","makeStyles","container","paddingBottom","navbar","bottom","right","borderRadius","overflow","boxShadow","BasicLayout","props","children","classes","Container","fixed","className","button","fontSize","Transition","forwardRef","ref","Slide","direction","Rest","setOpen","handleClose","Button","size","Dialog","aria-labelledby","aria-describedby","DialogTitle","DialogContent","DialogContentText","DialogActions","onConfirm","textTransform","icon","tips","Import","jsonText","setJsonText","error","setError","IconButton","onSubmit","preventDefault","json","parse","error1","TextField","required","autoFocus","multiline","rowsMax","rows","variant","margin","label","helperText","value","onChange","text","target","trim","InputProps","inputProps","pattern","fullWidth","eventTarget","Touch","identifier","pos","deltaX","deltaY","clientX","clientY","screenX","screenY","pageX","pageY","TouchList","touchList","identifiedTouch","onMouse","touchType","ev","which","dispatchEvent","eventName","mouseEv","touchEvent","document","createEvent","initEvent","altKey","ctrlKey","metaKey","shiftKey","touches","getActiveTouches","targetTouches","changedTouches","createTouchList","triggerTouch","TouchEmulator","objs","documentElement","o","p","undefined","fakeTouchSupport","addEventListener","multiTouchOffset","random","substring","isRender","chart","init","width","height","creator","data","F2","Chart","pixelRatio","devicePixelRatio","appendPadding","getParentRect","parentEl","canvas","parentElement","getBoundingClientRect","setState","destroy","node","Component","defaultStyle","LineChart","source","xKey","yKey","tickCount","range","tooltip","custom","showXTip","showYTip","snap","crosshairsType","crosshairsStyle","lineDash","yTip","axis","total","textCfg","textAlign","line","shape","render","style","PureComponent","defaultCreateChartDataOptions","xRange","xStep","createChartData","row","display","alignItems","flexWrap","center","mediumWidth","SimulateSetting","setValues","useEffect","handleInputChange","endAdornment","InputAdornment","placeholder","root","iconButton","padding","fnLabel","chartBox","userSelect","caclClass","number","StockItem","isShowSetting","simulateOptions","cycle","up_threshold","up_position","down_threshold","down_position","handleToogleSetting","flag","calcTargetPercent","targetRate","maxAbsEarnRate","calcPercentStyle","flex","earningsPerShare","earningCls","chartSource","percent","ceil","saveButton","editButton","sortTool","TYPE_MAP","asce","desc","StockList","setStocks","setSort","sortedStocks","store","useContext","list","ratio","s1","s2","Select","defaultValue","theme","heading","typography","pxToRem","flexBasis","flexShrink","panel","StockPanel","expanded","setExpanded","onSave","dispatch","Accordion","event","isExpanded","AccordionSummary","expandIcon","Typography","AccordionDetails","detial","defaultColor","SummaryPanel","_isEmpty","haha","paragraph","jsonp","Promise","resolve","reject","$","Error","ajax","success","res","err","header","justifyContent","marginTop","marginBottom","cursor","snackbar","backgroundColor","timer","DashBord","message","setTips","fetchStocks","pollStockInfo","clearTimeout","setTimeout","UPDATE_INTERVAL","fail","_codes","dataType","url","API_BASE_URL","join","then","status","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","tableIcons","Add","Check","Clear","Delete","DetailPanel","Edit","Export","Filter","FirstPage","LastPage","NextPage","PreviousPage","ResetSearch","Search","SortArrow","ThirdStateCheck","ViewColumn","columns","field","title","rowData","Positions","icons","editable","onRowAdd","newData","onRowUpdate","onRowDelete","actionsColumnIndex","paging","localization","actions","body","deleteTooltip","editTooltip","addTooltip","editRow","deleteText","globalError","console","App","useReducer","Provider","path","location","hostname","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","_STORAGE_KEY_","warn"],"mappings":"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","file":"static/js/main.f1755d5d.chunk.js","sourcesContent":["/**\n * 代入变量到公式并返回执行结果\n * @param {*} formula 公式\n * @param {*} variableKey 变量key\n * @param {*} variable 代入变量值\n */\nexport function excuteExpression(expression, vKey, vVal) {\n  const matchs = expression.match(new RegExp(vKey, 'gi'))\n  let newExpression = expression\n\n  if (matchs.length) {\n    matchs.forEach(() => {\n      const variableIdx = newExpression.indexOf(vKey)\n      const prevChart = newExpression[variableIdx - 1]\n      const nextChart = newExpression[variableIdx + 1]\n\n      if (variableIdx > -1) {\n        if (/\\d/.test(prevChart)) {\n          newExpression = newExpression.replaceAt(variableIdx, `*${vVal}`)\n        } else if (/\\d/.test(nextChart)) {\n          newExpression = newExpression.replaceAt(variableIdx, `${vVal}*`)\n        } else {\n          newExpression = newExpression.replaceAt(variableIdx, `${vVal}`)\n        }\n      }\n    })\n  }\n  // eslint-disable-next-line no-eval\n  return eval(newExpression)\n}\n","import Big from 'big.js';\nimport { getStocksStorage, setStocksStorage } from '@/reducers/storage'\nimport { DEFAULT_STOCKS, EXPECT_LOSS_RATE, ADVICE_LOSS_RATE } from '../constants';\nimport { excuteExpression } from './math'\n\nwindow.Big = Big;\n\n// eslint-disable-next-line no-extend-native\nString.prototype.replaceAt = function (index, replacement) {\n  return this.substr(0, index) + replacement + this.substr(index + 1);\n};\n\n// 对股票id进行处理\nexport function getStockCodes(stocks = []) {\n  return stocks.map((code) => {\n    if (isNaN(code[0])) {\n      if (code.toLowerCase().indexOf('us_') > -1) {\n        return code.toUpperCase();\n      } if (code.indexOf('hk') > -1) {\n        return code;\n      } \n        return code.toLowerCase().replace('sz', '1').replace('sh', '0');\n      \n    } \n      return (code[0] === '6' ? '0' : '1') + code;\n    \n  });\n}\n\n// 生成补仓函数\nexport function genFnForBC(stocks = []) {\n  return stocks.map((stock) => {\n    stock.bcFn = `((${stock.position}+x)${stock.price})/(${stock.costPrice}*${stock.position} + ${stock.price}x)`;\n    return stock;\n  });\n}\n\nexport function soryBy() {}\n\n/**\n * 根据反比函数公式，求一个最小近似值\n * @param {*} formula 公式，变量为x\n * @param {*} targetValue 目标值\n */\nfunction calcApproximateValue(formula = '', targetValue, options = {}) {\n  const { step = 1, startX = 0, endX, cycleCount = 300 } = options;\n  const realCycleCount = endX ? endX - startX + 1 : cycleCount;\n  let count = 0;\n  let i = 0;\n  const resultMap = {};\n\n  while (count < realCycleCount) {\n    const vX = step + i;\n    const formulaStr = excuteExpression(formula, 'x', vX);\n    // eslint-disable-next-line no-eval\n    const result = eval(formulaStr);\n    const delta = Math.abs(result - targetValue);\n\n    resultMap[delta] = { x: vX, y: result, times: count };\n    i += step;\n    count++;\n  }\n  const minDelta = Math.min(...Object.keys(resultMap));\n  const approObj = resultMap[minDelta];\n\n  return {\n    formula,\n    x: approObj.x,\n    y: approObj.y,\n    targetValue,\n    approValue: approObj.y,\n    step,\n  };\n}\n\n// 格式华\nexport function formatToLocalStocks(stocks = []) {\n  return stocks.map((stock) => ({\n    name: stock.name,\n    symbol: stock.symbol,\n    costPrice: stock.costPrice,\n    position: stock.position,\n    pe: stock.pe,\n    eps: stock.eps,\n    profits: stock.profits,\n    issue: stock.issue,\n  }));\n}\n\n// 初始化数据\nexport function initData() {\n  if (!localStorage.getItem('pageView')) {\n    localStorage.setItem('stocks', JSON.stringify(DEFAULT_STOCKS));\n    localStorage.setItem('pageView', 1);\n  } else {\n    const pageView = localStorage.getItem('pageView');\n    localStorage.setItem('pageView', Number(pageView) + 1);\n  }\n}\n\n// 重置数据\nexport function resetData(defaultJson = DEFAULT_STOCKS) {\n  setStocksStorage(defaultJson)\n}\n\n// 合并本地和接口数据\nexport function mergeStocks(serverStocks) {\n  const localStocks = getStocksStorage();\n  const serverStockMap = Object.values(serverStocks).reduce((sum, stock) => {\n    sum[stock.symbol] = stock;\n    return sum;\n  }, {});\n  // 合并成本价、持仓信息\n  const stocks = localStocks.map((localStock) => {\n    if (serverStockMap[localStock.symbol]) {\n      const stockItem = {\n        ...localStock,\n        ...serverStockMap[localStock.symbol],\n      };\n      // 每股计算的建议信息\n      let advice = {};\n      const { costPrice, price, position } = stockItem;\n\n      if (costPrice > price) {\n        stockItem.bcFn = `1-(${(position * price).toFixed(2)}+${price}x)/(${(costPrice * position).toFixed(\n          2,\n        )}+${price}x)`;\n      } else {\n        stockItem.jcFn = `(${(position * price).toFixed(2)}+${price}x)/(${(costPrice * position).toFixed(\n          2,\n        )}+${price}x)-1`;\n      }\n      stockItem.earnRate = price / costPrice - 1;\n\n      if (stockItem.earnRate < ADVICE_LOSS_RATE) {\n        advice = calcApproximateValue(stockItem.bcFn, -EXPECT_LOSS_RATE, { step: 100 });\n        advice.amount = (advice.x * stockItem.price).toFixed(2);\n      }\n\n      stockItem.advice = advice;\n      return stockItem;\n    } \n    return undefined;\n    \n  });\n\n  return [...stocks].filter(v => v);\n}\n\n// 计算持仓汇总信息\nexport function calcStockSummary(stockList) {\n  let summary = {\n    // 市值\n    marketValue: 0,\n    // 成本金额\n    costValue: 0,\n    // 盈亏金额\n    earnMoney: 0,\n    // 平均盈亏率\n    earnRate: 0,\n    // 建议\n    advice: {\n      // 建议流动资金\n      hotMoney: 0,\n    },\n    // 盈亏统计\n    earn: {\n      // 最小盈亏比\n      minRate: 0,\n      // 最大盈亏比\n      maxRate: 0,\n      // 最小盈亏金额\n      minMoney: 0,\n      // 最大盈亏金额\n      maxMoney: 0,\n      // 盈亏比绝对值最大值\n      maxAbsRate: 0,\n    },\n  };\n\n  summary = stockList.reduce((sum, item) => {\n    const adviceAmount = item.advice ? item.advice.amount : 0;\n\n    sum.marketValue = new Big(item.price).times(item.position).plus(sum.marketValue).valueOf();\n\n    sum.costValue = new Big(item.costPrice).times(item.position).plus(sum.costValue).valueOf();\n\n    sum.advice.hotMoney = new Big(sum.advice.hotMoney).plus(Number(adviceAmount || 0)).valueOf();\n\n    return sum;\n  }, summary);\n\n  summary.earnRate = new Big(summary.marketValue).div(summary.costValue || 1).minus(1).toFixed(4).valueOf();\n  summary.earnMoney = new Big(summary.marketValue).minus(summary.costValue).valueOf();\n\n  if (stockList && stockList.length > 0) {\n    const sortedByEarnRateList = stockList.sort((a, b) => a.earnRate - b.earnRate);\n    // 最小收益股票\n    const minRateStock = sortedByEarnRateList[0];\n    // 最大收益股票\n    const maxRateStock = sortedByEarnRateList[sortedByEarnRateList.length - 1];\n\n    summary.earn.minRate = minRateStock.earnRate;\n    summary.earn.maxRate = maxRateStock.earnRate;\n\n    summary.earn.minMoney = (minRateStock.earnRate * minRateStock.costPrice * minRateStock.position).toFixed(2);\n    summary.earn.maxMoney = (maxRateStock.earnRate * maxRateStock.costPrice * maxRateStock.position).toFixed(2);\n\n    summary.earn.maxAbsRate = Math.max(Math.abs(minRateStock.earnRate), Math.abs(maxRateStock.earnRate));\n  }\n\n  return summary;\n}\n\n/**\n * 求一个数的倍数\n *\n * @param n number\n * @param m 最小起倍数\n * @param options\n */\nexport function toMultiple(n, m, options = {}) {\n  const n1 = Number(n);\n  const m1 = Number(m);\n  // 返回值 是向上取整[ceil]，还是向下取整数[floor]\n  const { to = 'ceil' } = options;\n  const times = Math.floor(n1 / m1);\n\n  if (n1 === m1 || n1 % m1 === 0) {\n    return n1;\n  }\n\n  switch (to) {\n    case 'ceil': {\n      return Big(times).plus(1).times(m1).valueOf();\n    }\n    case 'floor': {\n      return Big(times).times(m1).valueOf();\n    }\n    default: {\n      return Big(times).plus(1).times(m1).valueOf();\n    }\n  }\n}\n\n// 格式化模拟设置\nexport const formatSimulateValues = (values) => {\n  const result = {};\n  Object.keys(values).forEach((key) => {\n    const keySplit = key.split('_');\n\n    if (keySplit.length > 1) {\n      const key0 = keySplit[0];\n      const key1 = keySplit[1];\n\n      if (result[key0]) {\n        result[key0][key1] = values[key];\n      } else {\n        result[key0] = {\n          [key1]: values[key],\n        };\n      }\n    } else {\n      result[key] = values[key];\n    }\n  });\n  result.down.threshold = -result.down.threshold / 100;\n  result.up.threshold = result.up.threshold / 100;\n  result.up.position = -result.up.position;\n  return result;\n};\n\n/**\n * 更新本地股票持仓\n *\n * @export\n * @param {*} key\n * @param {*} newValues\n * @returns\n */\nexport function updateStock(key, newValues) {\n  const localStocks = getStocksStorage();\n\n  const newStocks = localStocks.map((item) => {\n    if (String(item.symbol) === String(key)) {\n      return {\n        ...item,\n        ...newValues,\n      };\n    } \n      return item;\n    \n  });\n\n  setStocksStorage(formatToLocalStocks(newStocks))\n  return newStocks;\n}\n\nexport function calcTargetPrice1(values) {\n  return (values.profits * values.pe) / values.issue;\n}\n\nexport function calcTargetPrice2(values) {\n  return values.eps * values.pe;\n}\n","const objectToValuesPolyfill = (object) => {\n  return Object.keys(object).map(key => object[key]);\n};\n\nObject.values = Object.values || objectToValuesPolyfill;","export function isEmpty(obj) {\n  if(!obj) return true;\n\n  if(Array.isArray(obj)) {\n    return Object.keys(obj).length === 0\n  }\n\n  if (Object.prototype.toString.call(obj) === '[object Object]') {\n    return Object.keys(obj).length === 0\n  }\n}\n","import React from 'react'\nimport { calcStockSummary, mergeStocks } from '@/shared/common'\nimport { isEmpty } from '@/shared/utils'\nimport { getStocksStorage, setStocksStorage } from '@/reducers/storage'\n\nexport const initState = {\n  summary: {},\n  stocksMap: {},\n  _stocks: getStocksStorage(),\n  stocks: [],\n  showPostion: false,\n  isEdit: false,\n}\n\nexport function stockInit(initialData) {\n  return { ...initState, ...initialData }\n}\n\nexport function reducers(state, action) {\n  switch (action.type) {\n    case 'INIT_STOCK': {\n      if(isEmpty(action.payload)) return state\n\n      const stockList = mergeStocks(action.payload)\n      const summary = calcStockSummary(stockList)\n\n      return {\n        ...state,\n        summary,\n        stocksMap: action.payload,\n        stocks: stockList,\n      }\n    }\n    case '_INIT_STOCK_': {\n      setStocksStorage(action.payload)\n      return {\n        ...state,\n        _stocks: action.payload,\n      }\n    }\n    case '_ADD_STOCK_': {\n      setStocksStorage([...state._stocks, action.payload])\n      return {\n        ...state,\n        _stocks: [...state._stocks, action.payload],\n      }\n    }\n    case '_UPDATE_STOCK_': {\n      let targetIdx = -1\n      const _newStocks = [...state._stocks]\n      _newStocks.find((v, index) => {\n        targetIdx = index\n        return v.symbol === action.payload.symbol\n      })\n      if (targetIdx > -1) {\n        _newStocks[targetIdx] = action.payload\n      }\n\n      setStocksStorage(_newStocks)\n      return {\n        ...state,\n        _stocks: _newStocks,\n      }\n    }\n    case '_DEL_STOCK_': {\n      const _newStocks = state._stocks.filter((v) => v.symbol !== action.payload.symbol)\n\n      setStocksStorage(_newStocks)\n      return {\n        ...state,\n        _stocks: _newStocks,\n      }\n    }\n    default:\n      return state\n  }\n}\n\nexport const Context = React.createContext(initState)\n","import React, { useState } from 'react'\nimport { Fab, Menu, MenuItem, Fade } from '@material-ui/core'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport { useHistory } from 'react-router-dom'\n\nexport default function FloatButton() {\n  const history = useHistory()\n  const [anchorEl, setAnchorEl] = useState(null)\n  const open = Boolean(anchorEl)\n\n  const handleOpenMenu = (e) => {\n    setAnchorEl(e.currentTarget)\n  }\n\n  const handleClose = () => {\n    setAnchorEl(null)\n  }\n\n  const handleClick = (type) => {\n    history.push(type)\n    setAnchorEl(null)\n  }\n\n  return (\n    <>\n      <Fab\n        color=\"primary\"\n        aria-label=\"menu\"\n        aria-controls=\"fade-menu\"\n        aria-haspopup=\"true\"\n        onClick={handleOpenMenu}\n      >\n        <MenuIcon />\n      </Fab>\n\n      <Menu\n        id=\"fade-menu\"\n        anchorEl={anchorEl}\n        keepMounted\n        open={open}\n        onClose={handleClose}\n        TransitionComponent={Fade}\n      >\n        <MenuItem onClick={() => handleClick('dashbord')}>行情</MenuItem>\n        <MenuItem onClick={() => handleClick('positions')}>持仓</MenuItem>\n      </Menu>\n    </>\n  )\n}\n","import React from 'react'\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Container } from '@material-ui/core';\nimport FloatButtom from '../FloatButtom'\n\nconst useStyles = makeStyles({\n  container: {\n    paddingBottom: 60,\n  },\n  navbar: {\n    position: 'fixed',\n    bottom: 20,\n    right: 20,\n    borderRadius: 6,\n    overflow: 'hidden',\n    boxShadow: '1px 1px 5px 1px #eee',\n  },\n});\n\nexport default function BasicLayout(props) {\n  const { children } = props\n  const classes = useStyles()\n\n  return (\n    <Container fixed className={classes.container}>\n      { children }\n\n        <div className={classes.navbar}>\n          <FloatButtom />\n        </div>\n    </Container>\n  )\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\n\nconst useStyles = makeStyles(() => ({\n  button: {\n    color: '#555',\n    fontSize: 12,\n  },\n}));\n\nconst Transition = React.forwardRef((props, ref) => <Slide direction=\"up\" ref={ref} {...props} />);\n\nexport default function Rest(props) {\n  const classes = useStyles();\n  const [open, setOpen] = React.useState(false);\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleConfirm = () => {\n    setOpen(false);\n    props.onConfirm && props.onConfirm();\n  };\n\n  return (\n    <>\n      <Button size=\"small\" onClick={handleClickOpen} className={classes.button}>\n        reset\n      </Button>\n      <Dialog\n        open={open}\n        TransitionComponent={Transition}\n        keepMounted\n        onClose={handleClose}\n        aria-labelledby=\"alert-dialog-slide-title\"\n        aria-describedby=\"alert-dialog-slide-description\"\n      >\n        <DialogTitle id=\"alert-dialog-slide-title\">确定要重置持仓吗?</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-dialog-slide-description\">\n            重置后持仓将恢复默认的示例数据，该操作不可撤销。\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} color=\"primary\">\n            取消\n          </Button>\n          <Button onClick={handleConfirm} color=\"primary\">\n            确定\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </>\n  );\n}\n","import React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\nimport IconButton from '@material-ui/core/IconButton';\nimport TextField from '@material-ui/core/TextField';\nimport ImportExportIcon from '@material-ui/icons/ImportExport';\n\nconst useStyles = makeStyles(() => ({\n  button: {\n    color: '#888',\n    textTransform: 'uppercase',\n    fontSize: 15,\n  },\n  icon: {\n    fontSize: 20,\n  },\n  tips: {\n    fontSize: 14,\n  },\n}));\n\nconst Transition = React.forwardRef((props, ref) => <Slide direction=\"up\" ref={ref} {...props} />);\n\nexport default function Import(props) {\n  const classes = useStyles();\n\n  const [open, setOpen] = useState(false);\n  const [jsonText, setJsonText] = useState('');\n  const [error, setError] = useState('');\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleConfirm = () => {\n  };\n\n  const handleTextChange = (e) => {\n    const text = String(e.target.value).trim();\n    setJsonText(text);\n\n    text === '' && setError(false);\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    let json = false;\n\n    try {\n      json = JSON.parse(jsonText);\n      setError(false);\n    } catch (error1) {\n      setError('JSON解析错误, 请核验格式是否正确');\n      return;\n    }\n    if (!Array.isArray(json)) {\n      setError('JSON必须是一个持仓数组');\n      return;\n    }\n    if (json) {\n      setOpen(false);\n      setJsonText('');\n      props.onConfirm && props.onConfirm(json);\n    }\n  };\n\n  return (\n    <>\n      <IconButton aria-label=\"import\" size=\"small\" onClick={handleClickOpen} className={classes.button}>\n        <ImportExportIcon size=\"small\" className={classes.icon} />\n      </IconButton>\n      <Dialog\n        open={open}\n        TransitionComponent={Transition}\n        keepMounted\n        onClose={handleClose}\n        aria-labelledby=\"alert-dialog-slide-title\"\n        aria-describedby=\"alert-dialog-slide-description\"\n      >\n        <form onSubmit={handleSubmit}>\n          <DialogTitle id=\"alert-dialog-slide-title\">导入数据</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"alert-dialog-slide-description\" className={classes.tips}>\n              你可以通过导入JSON来快速初始化你的持仓数据。该操作会覆盖现有数据，请谨慎操作。\n            </DialogContentText>\n            <TextField\n              required\n              autoFocus\n              multiline\n              rowsMax=\"6\"\n              rows=\"2\"\n              variant=\"outlined\"\n              margin=\"dense\"\n              name=\"position\"\n              id=\"position\"\n              label=\"JSON字符串\"\n              type=\"text\"\n              error={Boolean(error)}\n              helperText={error}\n              value={jsonText}\n              onChange={handleTextChange}\n              InputProps={{\n                inputProps: {\n                  pattern: /^\\D/,\n                },\n              }}\n              fullWidth\n            />\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={handleClose} color=\"primary\">\n              取消\n            </Button>\n            <Button onClick={handleConfirm} color=\"primary\" type=\"submit\">\n              确定\n            </Button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </>\n  );\n}\n","/**\n * Emulate touch on desktop\n */\nlet eventTarget\n\n/**\n * create an touch point\n * @constructor\n * @param target\n * @param identifier\n * @param pos\n * @param deltaX\n * @param deltaY\n * @returns {Object} touchPoint\n */\n\nconst Touch = function Touch(target, identifier, pos, deltaX, deltaY) {\n  deltaX = deltaX || 0\n  deltaY = deltaY || 0\n\n  this.identifier = identifier\n  this.target = target\n  this.clientX = pos.clientX + deltaX\n  this.clientY = pos.clientY + deltaY\n  this.screenX = pos.screenX + deltaX\n  this.screenY = pos.screenY + deltaY\n  this.pageX = pos.pageX + deltaX\n  this.pageY = pos.pageY + deltaY\n}\n\n/**\n * create empty touchlist with the methods\n * @class\n * @return { Array } touchList\n */\nfunction TouchList() {\n  const touchList = []\n\n  touchList.item = function item(index) {\n    return this[index] || null\n  }\n\n  // specified by Mozilla\n  touchList.identifiedTouch = function identifiedTouch(id) {\n    return this[id + 1] || null\n  }\n\n  return touchList\n}\n\n/**\n * Simple trick to fake touch event support\n * this is enough for most libraries like Modernizr and Hammer\n */\nfunction fakeTouchSupport() {\n  const objs = [window, document.documentElement]\n  const props = ['ontouchstart', 'ontouchmove', 'ontouchcancel', 'ontouchend']\n\n  for (let o = 0; o < objs.length; o++) {\n    for (let p = 0; p < props.length; p++) {\n      if (objs[o] && objs[o][props[p]] === undefined) {\n        objs[o][props[p]] = null\n      }\n    }\n  }\n}\n\n/**\n * only trigger touches when the left mousebutton has been pressed\n * @param { String } touchType touchType\n * @return { Function } handler\n */\nfunction onMouse(touchType) {\n  return (ev) => {\n    // prevent mouse events\n\n    if (ev.which !== 1) {\n      return\n    }\n\n    // The EventTarget on which the touch point started when it was first placed on the surface,\n    // even if the touch point has since moved outside the interactive area of that element.\n    // also, when the target doesnt exist anymore, we update it\n    if (ev.type === 'mousedown' || !eventTarget || (eventTarget && !eventTarget.dispatchEvent)) {\n      eventTarget = ev.target\n    }\n\n    triggerTouch(touchType, ev)\n\n    // reset\n    if (ev.type === 'mouseup') {\n      eventTarget = null\n    }\n  }\n}\n\n/**\n * trigger a touch event\n * @param { String } eventName eventName\n * @param { Object } mouseEv mouseEv\n */\nfunction triggerTouch(eventName, mouseEv) {\n  const touchEvent = document.createEvent('Event')\n  touchEvent.initEvent(eventName, true, true)\n\n  touchEvent.altKey = mouseEv.altKey\n  touchEvent.ctrlKey = mouseEv.ctrlKey\n  touchEvent.metaKey = mouseEv.metaKey\n  touchEvent.shiftKey = mouseEv.shiftKey\n\n  touchEvent.touches = getActiveTouches(mouseEv)\n  touchEvent.targetTouches = getActiveTouches(mouseEv)\n  touchEvent.changedTouches = createTouchList(mouseEv)\n\n  eventTarget.dispatchEvent(touchEvent)\n}\n\n/**\n * create a touchList based on the mouse event\n * @param { Object } mouseEv mouseEv\n * @return { TouchList } touchList\n */\nfunction createTouchList(mouseEv) {\n  const touchList = TouchList()\n  touchList.push(new Touch(eventTarget, 1, mouseEv, 0, 0))\n  return touchList\n}\n\n/**\n * receive all active touches\n * @param { Object } mouseEv mouseEv\n * @return { TouchList } touchList\n */\nfunction getActiveTouches(mouseEv) {\n  // empty list\n  if (mouseEv.type === 'mouseup') {\n    return TouchList()\n  }\n  return createTouchList(mouseEv)\n}\n\n/**\n * desktop initializer\n * @param { HTMLElement } target target\n */\nfunction TouchEmulator(target) {\n  fakeTouchSupport()\n\n  target.addEventListener('mousedown', onMouse('touchstart'), true)\n  target.addEventListener('mousemove', onMouse('touchmove'), true)\n  target.addEventListener('mouseup', onMouse('touchend'), true)\n}\n\n// start distance when entering the multitouch mode\nTouchEmulator.multiTouchOffset = 75\n\nexport default TouchEmulator\n","import React, { Component } from 'react'\nimport F2 from '@antv/f2'\nimport TouchEmulator from '@/shared/TouchEmulator'\n\nexport default class extends Component {\n  id = `c${Math.random().toString(36).substring(7)}`\n\n  state = {\n    isRender: false,\n  }\n\n  chart = null\n\n  init = (options) => {\n    const { width = options.width, height = options.height, creator, data } = this.props\n    const chart = new F2.Chart({\n      id: this.id,\n      width,\n      height,\n      pixelRatio: window.devicePixelRatio,\n      // padding: [30, 0, 0, 0],\n      appendPadding: [10, 20, 6, 0],\n    })\n\n    creator(chart, data)\n    this.chart = chart\n  }\n\n  componentDidMount() {\n    const { width, height } = this.getParentRect()\n    this.init({\n      width,\n      height,\n    })\n  }\n\n  componentDidUpdate() {\n    const { isRender } = this.state\n\n    if (isRender) {\n      const { width, height } = this.getParentRect()\n\n      this.init({\n        width,\n        height,\n      })\n    }\n  }\n\n  getParentRect = () => {\n    const parentEl = this.canvas.parentElement\n\n    if (parentEl) {\n      const { width, height } = parentEl.getBoundingClientRect()\n\n      TouchEmulator(this.canvas)\n      this.setState({\n        isRender: true,\n      })\n      return { width, height }\n    }\n    this.setState({\n      isRender: false,\n    })\n    return {}\n  }\n\n  componentWillUnmount() {\n    this.chart.destroy()\n    this.chart = null\n  }\n\n  shouldComponentUpdate() {\n    return false\n  }\n\n  render() {\n    return (\n      <canvas\n        id={this.id}\n        ref={(node) => {\n          this.canvas = node\n        }}\n      />\n    )\n  }\n}\n","import React, { PureComponent } from 'react'\nimport Chart from './Chart'\n\nconst defaultStyle = {\n  width: '100%',\n  height: '100%',\n}\nexport default class LineChart extends PureComponent {\n  creator = (chart, data) => {\n    const { source, position } = data\n    const [xKey, yKey] = position.split('*')\n\n    chart.source(source, {\n      [yKey]: {\n        tickCount: 5,\n        min: 0,\n      },\n      [xKey]: {\n        type: 'linear',\n        range: [0, 1],\n        tickCount: 11,\n      },\n    })\n\n    chart.tooltip({\n      custom: true,\n      showXTip: true,\n      showYTip: true,\n      snap: true,\n      crosshairsType: 'xy',\n      crosshairsStyle: {\n        lineDash: [2],\n      },\n      yTip(value) {\n        return `${(value * 100).toFixed(2)}%`\n      },\n    })\n\n    chart.axis(xKey, {\n      label: function label(text, index, total) {\n        const textCfg = {}\n        if (index === 0) {\n          textCfg.textAlign = 'left'\n        } else if (index === total - 1) {\n          textCfg.textAlign = 'right'\n        }\n\n        textCfg.text = `${text / 100}手`\n        return textCfg\n      },\n    })\n\n    chart.axis(yKey, {\n      label: function label(value) {\n        const textCfg = {}\n\n        textCfg.text = `${(value * 100).toFixed(1)}%`\n        return textCfg\n      },\n    })\n\n    chart.line().position(position).shape('smooth')\n\n    chart.render()\n  }\n\n  render() {\n    const { source = [], position, width, height } = this.props\n    const style = {\n      width: width || defaultStyle.width,\n      height: height || defaultStyle.height,\n    }\n\n    return (\n      <div className=\"jsChartWrap\" style={style}>\n        <Chart data={{ source, position }} creator={this.creator} />\n      </div>\n    )\n  }\n}\n","import { excuteExpression } from './math'\n\nconst defaultCreateChartDataOptions = {\n  xRange: [0, 100],\n  xStep: 1,\n  xKey: 'x',\n  yKey: 'y',\n}\nexport function createChartData(expression, options = defaultCreateChartDataOptions) {\n  const { xRange, xStep, xKey, yKey } = { ...defaultCreateChartDataOptions, ...options }\n  const result = []\n  for (let i = xRange[0]; i <= xRange[1]; i += xStep) {\n    const y = excuteExpression(expression, 'x', i)\n    const item = {\n      [xKey]: i,\n      [yKey]: y,\n    }\n\n    result.push(item)\n  }\n\n  return result\n}\n","import React, { useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Slide from '@material-ui/core/Slide';\nimport TextField from '@material-ui/core/TextField';\n\nconst useStyles = makeStyles(() => ({\n  button: {\n    color: '#888',\n    textTransform: 'uppercase',\n    fontSize: 15,\n  },\n  row: {\n    display: 'flex',\n    alignItems: 'center',\n    flexWrap: 'wrap',\n  },\n  center: {\n    textAlign: 'center',\n    '& input': {\n      width: 150,\n      textAlign: 'center',\n    },\n  },\n  mediumWidth: {\n    width: 80,\n  },\n  tips: {\n    fontSize: 14,\n  },\n}));\n\nconst Transition = React.forwardRef((props, ref) => <Slide direction='up' ref={ref} {...props} />);\n\nexport default function SimulateSetting(props) {\n  const classes = useStyles();\n  const [values, setValues] = useState(props.data);\n  const [open, setOpen] = useState(props.open);\n\n  useEffect(() => {\n    setOpen(props.open);\n  }, [props.open]);\n\n  const handleInputChange = (e, key) => {\n    setValues({\n      ...values,\n      [key]: e.target.value,\n    });\n  };\n\n  const handleClose = () => {\n    props.onClose && props.onClose(true);\n  };\n\n  const handleConfirm = () => {\n    // props.onClose && props.onClose(true);\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    props.onClose && props.onClose(true);\n    props.onConfirm && props.onConfirm(values);\n  };\n\n  return (\n    <>\n      <Dialog\n        open={open}\n        TransitionComponent={Transition}\n        keepMounted\n        onClose={handleClose}\n        aria-labelledby='alert-dialog-slide-title'\n        aria-describedby='alert-dialog-slide-description'\n      >\n        <form onSubmit={handleSubmit}>\n          <DialogTitle id='alert-dialog-slide-title'>估值设置</DialogTitle>\n          <DialogContent>\n            {/* <DialogContentText id=\"alert-dialog-slide-description\" className={classes.tips}>\n              你可以通过导入JSON来快速初始化你的持仓数据。该操作会覆盖现有数据，请谨慎操作。\n            </DialogContentText> */}\n            <div className={classes.row}>\n              总股本：\n              <TextField\n                required\n                id='issue'\n                type='number'\n                value={values?.issue}\n                onChange={(e) => handleInputChange(e, 'issue')}\n                InputProps={{\n                  endAdornment: <InputAdornment position='start'>亿</InputAdornment>,\n                  className: classes.center,\n                }}\n              />\n            </div>\n            <div className={classes.row}>\n              预期EPS：\n              <TextField\n                required\n                id='eps'\n                placeholder='每股收益'\n                type='number'\n                value={values?.eps}\n                onChange={(e) => handleInputChange(e, 'eps')}\n                InputProps={{\n                  className: classes.center,\n                }}\n              />\n            </div>\n\n            <div className={classes.row}>\n              预期净利润：\n              <TextField\n                required\n                id='profits'\n                placeholder='年净利润'\n                type='number'\n                value={values?.profits}\n                onChange={(e) => handleInputChange(e, 'profits')}\n                InputProps={{\n                  endAdornment: <InputAdornment position='start'>亿</InputAdornment>,\n                  className: classes.center,\n                }}\n              />\n            </div>\n\n            <div className={classes.row}>\n              参考PE：\n              <TextField\n                required\n                id='pe'\n                type='number'\n                value={values?.pe}\n                placeholder='参考市盈率'\n                onChange={(e) => handleInputChange(e, 'pe')}\n                InputProps={{\n                  endAdornment: <InputAdornment position='start'>倍</InputAdornment>,\n                  className: classes.center,\n                }}\n              />\n            </div>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={handleClose} color='primary'>\n              取消\n            </Button>\n            <Button onClick={handleConfirm} color='primary' type='submit'>\n              确定\n            </Button>\n          </DialogActions>\n        </form>\n      </Dialog>\n    </>\n  );\n}\n","import React, { useState } from 'react'\nimport IconButton from '@material-ui/core/IconButton'\nimport SettingsIcon from '@material-ui/icons/Settings'\nimport { makeStyles } from '@material-ui/core/styles'\nimport LineChart from '@/components/Chart/LineChart'\nimport { createChartData } from '@/shared/chart'\nimport { toMultiple, updateStock, calcTargetPrice1, calcTargetPrice2 } from '../../shared/common'\nimport SettingPop from '../SettingPop'\n\nimport './StockItem.scss'\n\nconst useStyles = makeStyles({\n  root: {},\n  iconButton: {\n    padding: 6,\n  },\n  fnLabel: {\n    width: '110px !important',\n  },\n  chartBox: {\n    width: '100%',\n    height: 300,\n    userSelect: 'none',\n  },\n})\n\nfunction caclClass(number) {\n  if (number > 0) {\n    return 'red'\n  }\n  if (number < 0) {\n    return 'green'\n  }\n  return 'default'\n}\n\nexport default function StockItem(props) {\n  const classes = useStyles()\n  const [state, setState] = useState({\n    isShowSetting: false,\n    simulateOptions: {\n      p: 0.6,\n      cycle: 30,\n      up_threshold: 2,\n      up_position: 500,\n      down_threshold: 2,\n      down_position: 500,\n    },\n  })\n\n  // 打开/关闭设置面板\n  const handleToogleSetting = (flag) => {\n    setState({\n      isShowSetting: flag,\n    })\n  }\n\n  // 点击面板确定\n  const handleConfirm = (values) => {\n    if (values) {\n      updateStock(props.data.symbol, values)\n    }\n  }\n\n  const calcTargetPercent = (targetRate) => {\n    const { summary } = props\n\n    // 所有持仓最大亏损比绝对值\n    const maxAbsEarnRate = summary.earn.maxAbsRate\n    // 当前持仓亏损比绝对值\n    const currentAbsEarnRate = Math.abs(targetRate)\n    // 参考值，以此值作为基础值来计算百分比\n    const baseRate = toMultiple(maxAbsEarnRate, 0.05)\n    // 占比\n    const inPercent = (currentAbsEarnRate / baseRate).toFixed(2)\n\n    return inPercent\n  }\n\n  const calcPercentStyle = (targetRate) => ({\n    flex: calcTargetPercent(targetRate),\n  })\n\n  const { data } = props\n  const { isShowSetting } = state\n  // 每股收益\n  const earningsPerShare = data.price - data.costPrice\n  const earningCls = caclClass(earningsPerShare)\n\n  // 计算达到预期亏损的补仓建议\n  const { advice } = data\n\n  const style = calcPercentStyle(data.earnRate)\n\n  const chartSource = earningsPerShare < 0 ? createChartData(data.bcFn, {\n    xRange: [0, 1000],\n    xStep: 100,\n  }) : createChartData(data.jcFn, {\n    xRange: [0, 1000],\n    xStep: 100,\n  })\n\n  return (\n    <div className={`stock-item ${earningCls}`}>\n      <div className=\"title-box\">\n        <h3>{data.name || '无名股票'}</h3>\n        <div className=\"more-tools\">\n          <IconButton aria-label=\"setting\" onClick={() => handleToogleSetting(true)}>\n            <SettingsIcon />\n          </IconButton>\n        </div>\n      </div>\n      <SettingPop\n        open={isShowSetting}\n        data={data}\n        onConfirm={handleConfirm}\n        onClose={() => handleToogleSetting(false)}\n      />\n      <section>\n        <div className=\"row\">\n          <div className=\"cell stock-spc-item\">\n            <label className=\"stock-item-label\">成本</label>\n            <span className=\"stock-item-value\">{data.costPrice}</span>\n          </div>\n          <div className=\"cell stock-spc-item\">\n            <label className=\"stock-item-label\">持仓</label>\n            <span className=\"stock-item-value\">{data.position}</span>\n          </div>\n        </div>\n\n        <div className=\"white-blank\" />\n        <div className=\"row\">\n          <div className=\"cell stock-spc-item\">\n            <label className=\"stock-item-label\">现价</label>\n            <span className=\"stock-item-value\">{data.price}</span>\n          </div>\n          <div className=\"cell stock-spc-item\">\n            <label className=\"stock-item-label\">日浮{data.percent >= 0 ? '盈' : '亏'}</label>\n            <span className={`stock-item-value ${caclClass(data.percent)} weight`}>\n              {(data.costPrice * data.position * data.percent).toFixed(2)}\n            </span>\n          </div>\n        </div>\n\n        <div className=\"white-blank\" />\n        <div className=\"stock-spc-item percent-item\">\n          <label className=\"stock-item-label\">当日{data.percent >= 0 ? '涨' : '跌'}幅</label>\n          <span className={`stock-item-value weight ${caclClass(data.percent)}`}>\n            {(data.percent * 100).toFixed(2)}%\n            <i className=\"percent-bar\" style={{ width: `${Math.abs(data.percent * 1000)}%` }} />\n          </span>\n        </div>\n\n        <div className=\"white-blank\" />\n        <div className=\"stock-spc-item earn-rate-item\">\n          <label className=\"stock-item-label\">总盈亏</label>\n          <span className={`stock-item-value ${earningCls} weight`} style={style}>\n            <i className=\"earn-money\">\n              {earningsPerShare >= 0 ? '盈' : '亏'}:{' '}\n              {(data.earnRate * data.costPrice * data.position).toFixed(2)}元\n            </i>\n            {(data.earnRate * 100).toFixed(3)}%\n          </span>\n        </div>\n\n        {data.eps && data.pe && data.profits && (\n          <>\n            <div className=\"white-blank\" />\n            <div className=\"stock-spc-item earn-rate-item target\">\n              <label className=\"stock-item-label\">目标估值1</label>\n              <span\n                className={`stock-item-value ${caclClass(\n                  calcTargetPrice1(data) - data.costPrice\n                )} weight`}\n                style={calcPercentStyle(calcTargetPrice1(data) / data.costPrice - 1)}\n              >\n                <i className=\"earn-money\">估价1: {calcTargetPrice1(data).toFixed(2)}元</i>\n                {((calcTargetPrice1(data) / data.costPrice - 1) * 100).toFixed(3)}%\n              </span>\n            </div>\n          </>\n        )}\n\n        {data.eps && data.pe && data.profits && (\n          <>\n            <div className=\"white-blank\" />\n            <div className=\"stock-spc-item earn-rate-item target\">\n              <label className=\"stock-item-label\">目标估值2</label>\n              <span\n                className={`stock-item-value ${caclClass(\n                  calcTargetPrice2(data) - data.costPrice\n                )} weight`}\n                style={calcPercentStyle(calcTargetPrice2(data) / data.costPrice - 1)}\n              >\n                <i className=\"earn-money\">估价2: {calcTargetPrice2(data).toFixed(2)}元</i>\n                {((calcTargetPrice2(data) / data.costPrice - 1) * 100).toFixed(3)}%\n              </span>\n            </div>\n          </>\n        )}\n\n        <div className=\"white-blank\" />\n        <div className=\"stock-spc-item\">\n          <label className={`stock-item-label ${classes.fnLabel}`}>\n            {earningsPerShare < 0 ? '补仓收益曲线' : '加仓收益曲线'}\n          </label>\n        </div>\n\n        <div className={classes.chartBox}>\n          <LineChart source={chartSource} position=\"x*y\" />\n        </div>\n\n        <div className=\"white-blank\" />\n\n        {advice.x && (\n          <div className=\"stock-spc-item advice-item\">\n            <label className=\"stock-item-label\">建议</label>\n            <span className=\"stock-item-value advice-value\">\n              目前您的亏损超过了{Math.floor(Math.abs(data.earnRate) * 100)}%。建议补仓\n              <b className=\"mark\">{(advice.x / 100) >> 0}</b>\n              手， 需要资金\n              <b className=\"mark\">¥{Math.ceil(data.price * advice.x)}</b>, 可将亏损降至\n              <b className=\"mark\">{(advice.approValue * 100).toFixed(3)}%</b>。\n            </span>\n          </div>\n        )}\n      </section>\n    </div>\n  )\n}\n","import React, { useState, useEffect, useContext } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Select from '@material-ui/core/Select';\nimport { Context } from '@/reducers/index';\nimport StockItem from './StockItem';\n\nimport './StockList.scss';\n\nconst useStyles = makeStyles(() => ({\n  saveButton: {\n    color: '#fff',\n    fontSize: 16,\n  },\n  editButton: {\n    color: '#555',\n    fontSize: 15,\n  },\n  sortTool: {\n    fontSize: 14,\n  },\n}));\nconst TYPE_MAP = {\n  asce: 1,\n  desc: -1,\n};\n\nexport default function StockList(props) {\n  const classes = useStyles();\n  const [stocks, setStocks] = useState([]);\n  const [sort, setSort] = useState('default');\n  const [key, type] = sort.split(':');\n  let sortedStocks = [...stocks];\n\n  const { store } = useContext(Context);\n\n  useEffect(() => {\n    setStocks(props.list);\n  }, [props.list]);\n\n  // 排序选择权改变\n  const handleSortChange = e => {\n    setSort(e.target.value);\n  };\n\n\n  if (key === 'default') {\n    sortedStocks = stocks || [];\n  } else {\n    const ratio = TYPE_MAP[type] || 1;\n    sortedStocks = stocks.sort((s1, s2) => (s1[key] - s2[key]) * ratio);\n  }\n\n  const { summary } = store;\n\n  return (\n    <div className=\"stock-list-wrap\">\n      <div className=\"tools-box\">\n        <div className=\"sort-tool\">\n          <Select onChange={handleSortChange} defaultValue=\"default\" className={classes.sortTool}>\n            <MenuItem value=\"default\">默认排序</MenuItem>\n            <MenuItem value=\"earnRate:asce\">盈亏从低到高⬆</MenuItem>\n            <MenuItem value=\"earnRate:desc\">盈亏从高到低⬇</MenuItem>\n            <MenuItem value=\"percent:asce\">涨幅从低到高⬆</MenuItem>\n            <MenuItem value=\"percent:desc\">涨幅从高到低⬇</MenuItem>\n          </Select>\n        </div>\n      </div>\n      <div className=\"stock-list flow\">\n        {sortedStocks.map(stock => (\n          <StockItem key={stock.symbol} data={stock} summary={summary} />\n        ))}\n      </div>\n    </div>\n  );\n}\n","import StockList from './StockList'\n\nexport default StockList","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport Typography from '@material-ui/core/Typography';\nimport StockList from '../StockList';\n\nconst useStyles = makeStyles(theme => ({\n  heading: {\n    fontSize: theme.typography.pxToRem(15),\n    flexBasis: '33.33%',\n    flexShrink: 0,\n  },\n  panel: {\n    padding: '8px 18px 24px',\n  },\n}));\n\nexport default function StockPanel(props) {\n  const classes = useStyles();\n  const [expanded, setExpanded] = React.useState('panel2');\n\n  const handleChange = panel => (event, isExpanded) => {\n    setExpanded(isExpanded ? panel : false);\n  };\n\n  const { map, list, onSave, dispatch } = props;\n\n  return (\n    <Accordion expanded={expanded === 'panel2'} onChange={handleChange('panel2')}>\n      <AccordionSummary expandIcon={<ExpandMoreIcon />} aria-controls=\"panel2bh-content\" id=\"panel2bh-header\">\n        <Typography className={classes.heading}>持仓</Typography>\n      </AccordionSummary>\n      <AccordionDetails className={classes.panel}>\n        <StockList map={map} list={list} onSave={onSave} dispatch={dispatch} />\n      </AccordionDetails>\n    </Accordion>\n  );\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport Typography from '@material-ui/core/Typography';\nimport { isEmpty } from '@/shared/utils'\n\nconst useStyles = makeStyles(theme => ({\n  panel: {\n    display: 'block',\n  },\n  detial: {\n    display: 'block',\n  },\n  heading: {\n    fontSize: theme.typography.pxToRem(15),\n    flexBasis: '33.33%',\n    flexShrink: 0,\n  },\n  defaultColor: {\n    color: '#888',\n  },\n}));\n\nexport default function SummaryPanel(props) {\n  const classes = useStyles();\n  const [expanded, setExpanded] = React.useState('panel1');\n\n  const handleChange = panel => (event, isExpanded) => {\n    setExpanded(isExpanded ? panel : false);\n  };\n\n  const { summary = {}, list = [] } = props;\n  const _isEmpty = isEmpty(summary) || isEmpty(list)\n\n  return (\n    <Accordion className={classes.haha} expanded={expanded === 'panel1'} onChange={handleChange('panel1')}>\n      <AccordionSummary expandIcon={<ExpandMoreIcon />} aria-controls=\"panel2bh-content\" id=\"panel2bh-header\">\n        <Typography className={classes.heading}>总览</Typography>\n      </AccordionSummary>\n      <AccordionDetails className={classes.detial}>\n        {_isEmpty ? (\n          <>\n            <Typography display=\"inline\" color=\"error\">\n              请先添加持仓，才能查看总览。\n            </Typography>\n            <Typography display=\"inline\" className={classes.defaultColor} variant=\"body1\">\n              或者点击上方的RESET按钮,参看示例数据。\n            </Typography>\n          </>\n        ) : (\n          <>\n            <Typography display=\"block\" paragraph>\n              <span>你持仓的总市值为{summary.marketValue}。</span>\n              <span>总成本为{summary.costValue}。</span>\n              <span>\n                目前{summary.earnMoney >= 0 ? '盈利' : '亏损'} {Math.abs(summary.earnMoney)}元。\n              </span>\n              <span>盈亏率：{(summary.earnRate * 100).toFixed(2)}%。</span>\n            </Typography>\n            {Object.keys(summary.advice || {}).length > 0 && (\n              <Typography display=\"block\" color=\"error\">\n                建议账户保留流动资金{summary.advice?.hotMoney}元，以应对风险。\n              </Typography>\n            )}\n          </>\n        )}\n      </AccordionDetails>\n    </Accordion>\n  );\n}\n","export default function jsonp(options) {\n  return new Promise((resolve, reject) => {\n    if (!window.$) {\n      reject(new Error('不存在$.ajax'))\n    }\n\n    window.$.ajax({\n      ...options,\n      success(res) {\n        resolve(res)\n      },\n      error(err) {\n        reject(err)\n      },\n    })\n  })\n}\n","import React, { useEffect, useState, useContext } from 'react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Reset from '@/components/Reset'\nimport Import from '@/components/Import'\nimport StockPanel from '@/components/StockPanel'\nimport SummaryPanel from '@/components/SummaryPanel'\nimport { API_BASE_URL, UPDATE_INTERVAL, DEFAULT_STOCKS } from '@/constants'\nimport { getStockCodes, initData } from '@/shared/common'\nimport { Context } from '@/reducers/index'\nimport jsonp from '@/shared/request/jsonp'\nimport { isEmpty } from '@/shared/utils'\n\nconst useStyles = makeStyles(() => ({\n  root: {\n    width: '100%',\n  },\n  header: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginTop: 20,\n    marginBottom: 20,\n\n    '& .title-box': {\n      marginTop: 0,\n      marginBottom: 0,\n    },\n    '& .import-tool': {\n      cursor: 'pointer',\n      color: '#888',\n      fontSize: 14,\n    },\n  },\n  snackbar: {\n    '& .MuiSnackbarContent-root': {\n      padding: '2px 16px',\n    },\n    '&.error .MuiSnackbarContent-root': {\n      backgroundColor: 'rgb(253, 236, 234)',\n      color: 'rgb(97, 26, 21)',\n    },\n    '&.warning .MuiSnackbarContent-root': {\n      backgroundColor: 'rgb(255, 244, 229)',\n      color: 'rgb(102, 60, 0)',\n    },\n    '&.success .MuiSnackbarContent-root': {\n      backgroundColor: 'rgb(237, 247, 237)',\n      color: 'rgb(30, 70, 32)',\n    },\n  },\n}))\n// 定时器\nlet timer = null\n\nexport default function DashBord() {\n  const classes = useStyles()\n  const [tips, setTips] = useState({ open: false, message: '' })\n  const { store, dispatch } = useContext(Context)\n  const { _stocks ,stocksMap, summary } = store\n\n  useEffect(() => {\n    initData()\n    fetchStocks()\n    // 轮询\n    pollStockInfo()\n  \n    return () => {\n      clearTimeout(timer)\n    }\n  }, [_stocks])\n\n  // 轮询价格\n  const pollStockInfo = () => {\n    timer = setTimeout(() => {\n      fetchStocks()\n      pollStockInfo()\n    }, UPDATE_INTERVAL);\n  }\n\n  // 获取股票信息\n  function fetchStocks({ success, fail } = {}) {\n    const _codes = _stocks.map((stock) => String(stock.symbol))\n\n    if (isEmpty(_codes)) return\n\n    jsonp({\n      type: 'GET',\n      dataType: 'jsonp',\n      url: `${API_BASE_URL}${getStockCodes(_codes).join(',')}`,\n    }).then(\n      (serverStocks) => {\n        dispatch({\n          type: 'INIT_STOCK',\n          payload: serverStocks,\n        })\n        success && success(serverStocks)\n      },\n      (err) => {\n        fail && fail(err)\n      }\n    )\n  }\n\n  function handleTipClose() {\n    setTips({\n      status: 'default',\n      open: false,\n      message: '',\n    })\n  }\n\n  function handleResetConfirm() {\n    dispatch({\n      type: '_INIT_STOCK_',\n      payload: DEFAULT_STOCKS,\n    })\n    fetchStocks({\n      success() {\n        setTips({\n          status: 'success',\n          open: true,\n          message: '重置成功',\n        })\n      },\n      fail() {\n        setTips({\n          status: 'error',\n          open: true,\n          message: '重置失败',\n        })\n      },\n    })\n  }\n\n  function handleImportConfirm(json) {\n    if (json) {\n      dispatch({\n        type: '_INIT_STOCK_',\n        payload: json,\n      })\n      fetchStocks({\n        success: () => {\n          setTips({\n            status: 'success',\n            open: true,\n            message: '导入成功',\n          })\n        },\n        fail: () => {\n          setTips({\n            status: 'error',\n            open: true,\n            message: '导入失败',\n          })\n        },\n      })\n    }\n  }\n\n  return (\n    <>\n      <div className={classes.root}>\n        <div className={classes.header}>\n          <h2 className=\"title-box\">\n            STOCK HELPER\n            <Reset onConfirm={handleResetConfirm} />\n          </h2>\n          <div className=\"import-tool\">\n            <Import onConfirm={handleImportConfirm} />\n          </div>\n        </div>\n        <SummaryPanel map={stocksMap} list={store.stocks} summary={summary} />\n        <StockPanel map={stocksMap} list={store.stocks} dispatch={dispatch} />\n      </div>\n\n      <Snackbar\n        className={`${classes.snackbar} ${tips.status}`}\n        anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\n        open={tips.open}\n        onClose={handleTipClose}\n        autoHideDuration={3000}\n        message={tips.message}\n      />\n    </>\n  )\n}\n","\nimport React, { forwardRef } from 'react'\n\nimport AddBox from '@material-ui/icons/AddBox'\nimport ArrowDownward from '@material-ui/icons/ArrowDownward'\nimport Check from '@material-ui/icons/Check'\nimport ChevronLeft from '@material-ui/icons/ChevronLeft'\nimport ChevronRight from '@material-ui/icons/ChevronRight'\nimport Clear from '@material-ui/icons/Clear'\nimport DeleteOutline from '@material-ui/icons/DeleteOutline'\nimport Edit from '@material-ui/icons/Edit'\nimport FilterList from '@material-ui/icons/FilterList'\nimport FirstPage from '@material-ui/icons/FirstPage'\nimport LastPage from '@material-ui/icons/LastPage'\nimport Remove from '@material-ui/icons/Remove'\nimport SaveAlt from '@material-ui/icons/SaveAlt'\nimport Search from '@material-ui/icons/Search'\nimport ViewColumn from '@material-ui/icons/ViewColumn'\n\nconst tableIcons = {\n  Add: forwardRef((props, ref) => <AddBox color=\"primary\" {...props} ref={ref} />),\n  Check: forwardRef((props, ref) => <Check {...props} ref={ref} />),\n  Clear: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\n  Delete: forwardRef((props, ref) => <DeleteOutline color=\"secondary\" {...props} ref={ref} />),\n  DetailPanel: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\n  Edit: forwardRef((props, ref) => <Edit {...props} ref={ref} />),\n  Export: forwardRef((props, ref) => <SaveAlt {...props} ref={ref} />),\n  Filter: forwardRef((props, ref) => <FilterList {...props} ref={ref} />),\n  FirstPage: forwardRef((props, ref) => <FirstPage {...props} ref={ref} />),\n  LastPage: forwardRef((props, ref) => <LastPage {...props} ref={ref} />),\n  NextPage: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\n  PreviousPage: forwardRef((props, ref) => <ChevronLeft {...props} ref={ref} />),\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref} />),\n  SortArrow: forwardRef((props, ref) => <ArrowDownward {...props} ref={ref} />),\n  ThirdStateCheck: forwardRef((props, ref) => <Remove {...props} ref={ref} />),\n  ViewColumn: forwardRef((props, ref) => <ViewColumn {...props} ref={ref} />),\n}\n\nexport default tableIcons\n","import React, { useContext } from 'react'\nimport { Context } from '@/reducers/index'\nimport { makeStyles } from '@material-ui/core/styles'\nimport MaterialTable from 'material-table'\nimport tableIcons from '@/constants/tableIcons'\n\nconst useStyles = makeStyles({\n  root: {},\n  iconButton: {\n    padding: 6,\n  },\n})\n\nconst columns = [\n  {\n    field: 'symbol',\n    title: '名称',\n    render: (rowData) => (\n      <span>\n        {rowData.name}({rowData.symbol})\n      </span>\n    ),\n  },\n\n  {\n    field: 'costPrice',\n    title: '成本',\n  },\n  {\n    field: 'position',\n    title: '持仓',\n  },\n]\n\nexport default function Positions() {\n  const classes = useStyles()\n  const { store, dispatch } = useContext(Context)\n\n  const handleAdd = (newData) =>\n    new Promise((resolve) => {\n      resolve(\n        dispatch({\n          type: '_ADD_STOCK_',\n          payload: newData,\n        })\n      )\n    })\n\n  const handleUpdate = (newData) =>\n    new Promise((resolve) => {\n      resolve(\n        dispatch({\n          type: '_UPDATE_STOCK_',\n          payload: newData,\n        })\n      )\n    })\n\n  const handleDlete = (rowData) =>\n    new Promise((resolve) => {\n      resolve(\n        dispatch({\n          type: '_DEL_STOCK_',\n          payload: rowData,\n        })\n      )\n    })\n  return (\n    <div className={classes.root}>\n      <MaterialTable\n        title=\"持仓\"\n        icons={tableIcons}\n        columns={columns}\n        data={store._stocks}\n        editable={{\n          onRowAdd: handleAdd,\n          onRowUpdate: handleUpdate,\n          onRowDelete: handleDlete,\n        }}\n        options={{\n          actionsColumnIndex: -1,\n          paging: false,\n        }}\n        localization={{\n          header: { actions: '操作' },\n          body: {\n            deleteTooltip: '删除',\n            editTooltip: '编辑',\n            addTooltip: '添加',\n            editRow: {\n              deleteText: '确定删除吗?',\n            },\n          },\n        }}\n      />\n    </div>\n  )\n}\n","import React, { useReducer } from 'react'\nimport { HashRouter as Router, Switch, Route } from 'react-router-dom'\nimport { reducers, initState, Context } from '@/reducers/index'\nimport BasicLayout from './components/BasicLayout'\nimport Dashbord from './pages/Dashbord'\nimport Positions from './pages/Positions'\n\nimport './App.scss'\n\nfunction App() {\n  const [store, dispatch] = useReducer(reducers, initState)\n\n  return (\n    <Router>\n      <Context.Provider value={{ store, dispatch }}>\n        <div className=\"App\">\n          <BasicLayout>\n            <Switch>\n              <Route path=\"/dashbord\">\n                <Dashbord />\n              </Route>\n              <Route path=\"/positions\">\n                <Positions />\n              </Route>\n              <Route path=\"/\">404</Route>\n            </Switch>\n          </BasicLayout>\n        </div>\n      </Context.Provider>\n    </Router>\n  )\n}\n\n/**\n * 容错\n */\nwindow.addEventListener('error', (globalError) => {\n  console.error('addEventListener error', globalError)\n  // const r = window.confirm(`数据错误，将重置数据。\\n${globalError.message}`)\n  // if(r === true) {\n  //   resetData();\n  //   window.location.reload();\n  // }\n})\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport './shared/polyfill';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","const _STORAGE_KEY_ = 'stocks'\n\nexport function setStocksStorage(stocks) {\n  localStorage.setItem(_STORAGE_KEY_, JSON.stringify(stocks))\n}\n\nexport function getStocksStorage() {\n  let _stocks = []\n\n  try {\n    _stocks = JSON.parse(localStorage.getItem(_STORAGE_KEY_)) || []\n  } catch (err) {\n    console.warn('读取localStorage报错', err)\n  }\n\n  return _stocks\n}\n","// 第三方股市报价api\nexport const API_BASE_URL = 'https://api.money.126.net/data/feed/';\n\n// 第三方股市财务api\nexport const API_QUOTE_URL = 'https://stock.xueqiu.com/v5/stock/quote.json';\n\nexport const SINA_API = 'https://hq.sinajs.cn/list='\n\n// 刷新间隔（毫秒）\nexport const UPDATE_INTERVAL = 3000;\n\n// 期望承受亏损比率\nexport const EXPECT_LOSS_RATE = -0.06;\n\n// 亏损建议值： 当亏损率为该值，计算建议\nexport const ADVICE_LOSS_RATE = -0.059;\n\n// 持仓股\nexport const DEFAULT_STOCKS = [\n  {\n    name: '伊利股份',\n    // 股票代码\n    symbol: '600887',\n    // 成本价\n    costPrice: 30.243,\n    // 仓位，多少股\n    position: 400,\n  },\n  {\n    name: '中国平安',\n    // 股票代码\n    symbol: '601318',\n    // 成本价\n    costPrice: 77.987,\n    // 仓位，多少股\n    position: 200,\n  },\n  {\n    name: '格力电器',\n    // 股票代码\n    symbol: '000651',\n    // 成本价\n    costPrice: 60.625,\n    // 仓位，多少股\n    position: 200,\n  },\n  {\n    name: '东山精密',\n    // 股票代码\n    symbol: '002384',\n    // 成本价\n    costPrice: 28.213,\n    // 仓位，多少股\n    position: 400,\n  },\n  {\n    name: '华天科技',\n    // 股票代码\n    symbol: '002185',\n    // 成本价\n    costPrice: 12.870,\n    // 仓位，多少股\n    position: 100,\n  },\n  {\n    name: '华新水泥',\n    // 股票代码\n    symbol: '600801',\n    // 成本价\n    costPrice: 23.813,\n    // 仓位，多少股\n    position: 400,\n  },\n  {\n    name: '海螺水泥',\n    // 股票代码\n    symbol: '600585',\n    // 成本价\n    costPrice: 51.851,\n    // 仓位，多少股\n    position: 100,\n  },\n];\n"],"sourceRoot":""}